{"id":"saf-site-vitepress-0e1","title":"Add SAF media library content","description":"Add media records for presentations, videos, PDFs.\n\n## Content Types\n- Conference presentations (SANS, RSA, etc.)\n- YouTube videos and tutorials\n- PDF guides and whitepapers\n- Webinar recordings\n\n## Fields\n- media_type (FK), organization (FK)\n- url or file upload, thumbnail\n- event_name, event_date for conferences","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T11:19:39.352868-05:00","created_by":"alippold","updated_at":"2026-01-14T11:19:39.352868-05:00","dependencies":[{"issue_id":"saf-site-vitepress-0e1","depends_on_id":"saf-site-vitepress-6c8","type":"blocks","created_at":"2026-01-14T11:19:56.883168-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-2jp","title":"EPIC: Monorepo with Site + Dev Docs","description":"Convert to pnpm workspaces monorepo with two VitePress sites running side by side on different ports","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-15T08:32:44.144016-05:00","created_by":"alippold","updated_at":"2026-01-15T08:32:44.144016-05:00"}
{"id":"saf-site-vitepress-2k2","title":"EPIC: Core Layouts","description":"Build foundational page layouts: home, doc pages with typography, browse pages pattern. These are required before content migration.","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-12T17:23:41.751349-05:00","created_by":"alippold","updated_at":"2026-01-12T17:23:41.751349-05:00","dependencies":[{"issue_id":"saf-site-vitepress-2k2","depends_on_id":"saf-site-vitepress-42k","type":"blocks","created_at":"2026-01-12T17:25:03.983567-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-2k2","depends_on_id":"saf-site-vitepress-npl","type":"blocks","created_at":"2026-01-12T17:25:04.122509-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-2k2","depends_on_id":"saf-site-vitepress-dst","type":"blocks","created_at":"2026-01-12T17:25:04.265525-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-2k2","depends_on_id":"saf-site-vitepress-5es","type":"blocks","created_at":"2026-01-12T17:25:04.386326-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-2k2","depends_on_id":"saf-site-vitepress-dfg","type":"blocks","created_at":"2026-01-12T18:46:06.245135-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-33i","title":"PROJECT CONTEXT: VitePress POC for SAF Site","description":"## Project Overview\n\n**Goal**: Evaluate VitePress as replacement for Nuxt for MITRE SAF documentation site (open source version)\n\n**Why VitePress?**\n- Separate visual identity from commercial product (which uses Nuxt UI)\n- Avoid brand confusion between OSS and commercial offerings\n- Potentially better performance and simpler hosting (static site)\n- Built-in local search, good documentation tooling\n\n**Repository**: https://github.com/mitre/saf-site-vitepress\n**Original Nuxt repo**: `/Users/alippold/github/mitre/saf-site-v4`\n\n## Success Criteria\n\nThis POC needs to prove VitePress can handle:\n1. **Complex relational data**: Profiles, hardening guides, standards with FK relationships\n2. **Interactive features**: Client-side filters, search, browse pages\n3. **Production-quality components**: Good defaults, accessible, maintainable\n4. **Static site generation**: Fast builds, good bundle size\n5. **Content architecture**: Pocketbase database with VitePress data loaders\n\n## Content Management Architecture (APPROVED)\n\n**Decision (Sessions 014-015)**: Pocketbase is the content management system and single source of truth\n\n**Pocketbase 0.23.9** (CRITICAL API CHANGES):\n- Admin auth moved to `_superusers` collection\n- Use `pb.collection('_superusers').authWithPassword()` NOT `pb.admins.authWithPassword()`\n- Admin: admin@localhost.com / testpassword123\n- URL: http://127.0.0.1:8090\n\n**Why Pocketbase**:\n- Relational database with FK constraints enforced at DB level\n- FK expansion via REST API (`?expand=target,standard,technology`)\n- Version control via sqlite-diffable (git-friendly NDJSON)\n- No intermediate exports (database is source of truth)\n\n**Content Workflow**:\n```\nEdit in Pocketbase → Export DB (sqlite-diffable) → Commit → VitePress queries Pocketbase API → Build static site\n```\n\n## Schema v2 (28 Collections)\n\n**Current v2 Collections** (all prefixed `v2_`):\n- **Lookup Tables** (9): capabilities, categories, organizations, tags, tool_types, distribution_types, registries, resource_types, media_types\n- **Reference Tables** (4): teams, technologies, standards, targets\n- **Main Content** (5): content (unified), tools, courses, distributions, media\n- **Junction Tables** (10+): content_tags, content_capabilities, content_relationships, etc.\n\n**Current Data**:\n- v2_content: 82 records (78 validation + 4 hardening)\n- v2_tags: 52, v2_organizations: 16, v2_technologies: 8\n- v2_standards: 18, v2_teams: 4, v2_targets: 26\n- v2_categories: 7, v2_capabilities: 5\n- v2_content_tags: 117 junction records\n\n**Legacy v1** (to be removed after validation):\n- profiles, hardening_profiles, profiles_tags, hardening_profiles_tags, validation_to_hardening\n\n## High-Level Work Tracks\n\n### Track 1: Core Infrastructure ✅ COMPLETE\n- ✅ Establish layout patterns (doc vs page)\n- ✅ Choose component library (Reka UI approved)\n- ✅ Build reusable page layouts (browse pages with full-width)\n- ✅ Set up Pocketbase content management\n- ✅ Database version control with sqlite-diffable\n- ✅ Data import from YAML (one-time migration)\n- ✅ Schema v2 with 28 collections (3NF normalized)\n\n### Track 2: VitePress Integration (IN PROGRESS)\n- Update data loaders for v2 collections (_superusers auth)\n- Test browse pages with v2_content data\n- Export database via sqlite-diffable\n- Verify FK expansion in filters/displays\n- Create dynamic routes for detail pages\n\n### Track 3: Production Evaluation\n- Build performance testing\n- Bundle size analysis\n- Search quality validation\n- Deployment strategy (CI/CD with Pocketbase)\n- Final decision: VitePress vs Nuxt\n\n## Key Constraints\n\n- **NO commercial product references** in code/docs/beads\n- Use hub-spoke pattern in beads (NOT markdown documentation files)\n- This is production evaluation, not just a POC throwaway\n- Database is single source of truth (no YAML exports)\n\n## Tech Stack\n\n- **Framework**: VitePress 1.6.4\n- **Components**: Reka UI 2.7.0 (headless, Vue-native)\n- **Data**: Pocketbase 0.23.9 (relational database, REST API)\n- **Version Control**: sqlite-diffable (git-friendly NDJSON exports)\n- **Data Loaders**: VitePress data loaders query Pocketbase API at build time\n- **Styling**: VitePress default theme + MITRE branding\n- **Search**: VitePress built-in local search","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-12T17:34:28.228194-05:00","created_by":"alippold","updated_at":"2026-01-14T11:39:12.968895-05:00"}
{"id":"saf-site-vitepress-35u","title":"SPOKE: Database \u0026 Pocketbase Workflow","description":"DATABASE WORKFLOW SPOKE\n\nCRITICAL RULE:\nALWAYS backup data.db BEFORE running sqlite-diffable load!\ncp .pocketbase/pb_data/data.db .pocketbase/pb_data/data.db.backup-$(date +%Y%m%d-%H%M%S)\n\nDAILY WORKFLOW:\n1. Start Pocketbase: cd .pocketbase \u0026\u0026 ./pocketbase serve\n2. Edit content: http://localhost:8090/_/\n3. Login: admin@localhost.com / testpassword123\n4. Export changes: pnpm db:export\n5. Commit: git add .pocketbase/pb_data/diffable/ \u0026\u0026 git commit\n\nAFTER GIT PULL:\npnpm setup  # Restores database from diffable/\n\nSCHEMA SCRIPTS:\n- scripts/create-schema-v2-collections.ts - Creates v2 schema (33 collections)\n- scripts/migrate-v1-to-v2.ts - Populates v2 from v1 data\n- scripts/v1-export/*.json - V1 data exports (CRITICAL - keep these!)\n\nPOCKETBASE API PATTERNS:\n```typescript\nconst pb = new PocketBase('http://localhost:8090')\nconst profiles = await pb.collection('v2_content').getFullList({\n  expand: 'target,standard,technology,vendor,maintainer',\n  filter: 'content_type = \"validation\"'\n})\n```\n\nTROUBLESHOOTING:\n- Migration errors on startup: rm -rf .pocketbase/pb_migrations/*\n- Invalid settings error: Check _params table for corrupted data\n- Data not updating: pnpm reload-data\n\nCOLLECTIONS:\nv1 (legacy): profiles, hardening_profiles, organizations, standards, etc.\nv2 (new): v2_content, v2_tools, v2_courses, v2_media, + 29 more","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-15T07:16:13.76509-05:00","created_by":"alippold","updated_at":"2026-01-15T07:16:13.76509-05:00"}
{"id":"saf-site-vitepress-3gm","title":"EPIC: pb-cli Integration \u0026 Documentation","description":"Integrate pb-cli into project workflow for database management and backup","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-15T08:27:27.002738-05:00","created_by":"alippold","updated_at":"2026-01-15T08:30:50.339194-05:00","closed_at":"2026-01-15T08:30:50.339194-05:00","close_reason":"All tasks completed: package.json scripts, README, CONTRIBUTING, setup.sh"}
{"id":"saf-site-vitepress-3kb","title":"SESSION 017: Execute Taxonomy Transformation","description":"SESSION 017 - Taxonomy Transformation Execution\n\nCOMPLETED THIS SESSION:\n✅ Identified data quality issues (56/78 profiles marked \"Cross Platform\")\n✅ Designed clean taxonomy structure (Target Type, OS Family, Category, Vendor)\n✅ Created visual mockups and filter UX design\n✅ Wrote complete 5-phase implementation plan (3-4 hours)\n✅ Saved all planning docs to docs/taxonomy/ (51k documentation)\n✅ Fixed dropdown transparency issue (global styles for portaled content)\n\nCURRENT STATE:\n- Pocketbase running: http://localhost:8090 (78 profiles, 5 hardening)\n- Dev server: User will restart when needed\n- Planning complete: docs/taxonomy/taxonomy-transformation-plan.md\n- Current filters: 6 dropdowns (Category, Tech, Platform, Vendor, Standard, Search)\n- Issue: Current filters use old taxonomy (Platform = \"Cross Platform\" for 56 profiles)\n\nTAXONOMY DESIGN (docs/taxonomy/taxonomy-proposal.md):\n- Target Type: Operating System, Database, Web Server, Container, Virtualization, Cloud Service\n- Target Subtype: Linux, MySQL, Apache, Docker, ESXi, AWS, etc.\n- OS Family: Linux, Windows, Cross-Platform, Cloud-Native, N/A\n- Category: Operating Systems, Databases, Web Infrastructure, Container Platforms, etc.\n- Standard: STIG, CIS, SRG (already exists as relation)\n- Vendor: Microsoft, VMware, Red Hat, AWS, Google, Oracle (corrected)\n- Profile Maintainer: MITRE SAF, VMware, Google, Community\n\nNEXT SESSION - PHASE 1: Schema Updates (30 min):\n1. Start Pocketbase if not running: cd .pocketbase \u0026\u0026 ./pocketbase serve\n2. Open Pocketbase Admin UI: http://localhost:8090/_/\n3. Add new fields to profiles collection:\n   - target_type (text)\n   - target_subtype (text)\n   - os_family (text)\n   - profile_maintainer (text)\n4. Add same fields to hardening_profiles collection\n5. Can use Admin UI or create migration script (scripts/add-taxonomy-fields.ts)\n\nAFTER PHASE 1: Data Transformation (1.5 hrs):\n- Run transformation script with 40+ pattern matching rules\n- Transform 78 validation + 5 hardening profiles\n- Manual review of 10-20 edge cases\n- Verify coverage and export to git\n\nFULL PLAN: docs/taxonomy/taxonomy-transformation-plan.md\n\nFILES TO REVIEW:\n- docs/taxonomy/README.md - Overview\n- docs/taxonomy/taxonomy-proposal.md - Complete design\n- docs/taxonomy/taxonomy-visual.md - Visual mockups\n- docs/taxonomy/taxonomy-transformation-plan.md - 5-phase implementation\n\nGIT STATUS:\n- Uncommitted: ProfileFilters.vue, validate/index.md (dropdown fixes)\n- Should commit dropdown fixes before starting transformation","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T15:52:09.319943-05:00","created_by":"alippold","updated_at":"2026-01-13T16:29:26.528724-05:00","closed_at":"2026-01-13T16:29:26.528724-05:00","close_reason":"Context recovered, starting Phase 1 schema updates"}
{"id":"saf-site-vitepress-42k","title":"Create home page layout with hero","description":"Build home page (/) with hero section, features grid, and getting started section. Use layout: page for full custom design.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-12T17:24:13.970896-05:00","created_by":"alippold","updated_at":"2026-01-12T19:59:02.845186-05:00","closed_at":"2026-01-12T19:59:02.845186-05:00","close_reason":"Home page already complete with hero, features, and content"}
{"id":"saf-site-vitepress-4ja","title":"Port composables from saf-site-v4","description":"## Port Composables from saf-site-v4\n\n**Goal:** Adapt existing composables to work with VitePress data loaders instead of Nuxt Content.\n\n**Source:** `/Users/alippold/github/mitre/saf-site-v4/app/composables/`\n\n**Target:** `docs/.vitepress/composables/`\n\n**Composables to Port:**\n\n### 1. useProfiles.ts (~170 lines)\n**What it provides:**\n- Computed filter lists: standards, categories, platforms, organizations\n- Computed counts: countsByStandard, countsByStatus\n- Filter function with multiple criteria\n- Search function (name, description, id)\n\n**Adaptation:**\n```typescript\n// OLD (Nuxt Content):\nconst files = await queryCollection\u003cProfilesFile\u003e('profiles').all()\n\n// NEW (VitePress data loader):\nimport { data } from '../loaders/profiles.data'\nconst profiles = computed(() =\u003e data.profiles)\n```\n\n**Reuse:** ~80% (only data source changes)\n\n### 2. useHardeningProfiles.ts (~150 lines)\nSimilar pattern to useProfiles but for hardening guides.\n\n**Reuse:** ~80%\n\n### 3. useStandards.ts (~100 lines)\nLoads and filters security standards.\n\n**Reuse:** ~80%\n\n### 4. useOrganizations.ts (~60 lines)\nOrganization metadata and filtering.\n\n**Reuse:** ~90% (pure utility functions)\n\n### 5. useTeams.ts (~55 lines)\nTeam metadata and filtering.\n\n**Reuse:** ~90%\n\n**Key Changes:**\n- Replace `queryCollection()` with data loader imports\n- Remove `loading` state (data loaded at build time)\n- Keep all filter/search/count logic (it's generic)\n- Update types to match schema.ts\n\n**Testing:**\n- Import in browse pages\n- Test filters work correctly\n- Verify computed values update reactively\n- Check TypeScript types are correct\n\n**Dependencies:** \n- Requires schema.ts (saf-site-vitepress-sc2)\n- Requires data loaders to be updated (saf-site-vitepress-l7u)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-12T19:37:49.815349-05:00","created_by":"alippold","updated_at":"2026-01-14T11:07:31.129173-05:00","closed_at":"2026-01-14T11:07:31.129173-05:00","close_reason":"Outdated - composables will be fresh for Pocketbase v2, not ported from Nuxt","dependencies":[{"issue_id":"saf-site-vitepress-4ja","depends_on_id":"saf-site-vitepress-sc2","type":"blocks","created_at":"2026-01-12T19:37:50.021434-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-4ja","depends_on_id":"saf-site-vitepress-l7u","type":"blocks","created_at":"2026-01-12T19:37:50.143123-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-4xh","title":"RECOVERY: Session 024 Context","description":"SESSION 024 RECOVERY - 2026-01-14\n\nWORKFLOW:\nThis project uses BEADS for task tracking and Pocketbase for content management.\nKey project context card: bd show saf-site-vitepress-33i\n\nPOCKETBASE CRITICAL INFO:\n- URL: http://127.0.0.1:8090\n- Admin: admin@localhost.com / testpassword123\n- PocketBase 0.23+ uses _superusers for auth (NOT admins API)\n- Start: cd .pocketbase \u0026\u0026 ./pocketbase serve\n\npb-cli CONTEXT:\n- 39 collections configured (9 v1 + 30 v2)\n- Auth valid, all v2_ collections added\n\nCOMPLETED THIS SESSION:\n1. ProfileDetail layout improvements\n   - Left-aligned content (matches doc page pattern)\n   - Moved benchmark version below title\n   - Option B: minimal tags, full cards (5 cards: Target, Standard, Technology, Vendor, Maintainer)\n\n2. STIG version formatter\n   - Added formatBenchmarkVersion() function\n   - 2.2.0 → V2R2 (for STIGs)\n   - CIS keeps semver format\n   - Computed property in component\n\n3. Data fixes for RHEL8 STIG\n   - Updated description (was duplicate of name)\n   - Updated version to 2.2.0 (V2R2)\n\n4. Documentation\n   - Updated CLAUDE.md with default layout pattern\n   - Created beads card saf-site-vitepress-6cs for layout pattern reference\n   - Created beads card saf-site-vitepress-p80 for composables refactor\n\nNEXT SESSION - COMPOSABLES REFACTOR:\nCard: bd show saf-site-vitepress-p80\n\nArchitecture to implement:\n```\nPocketbase API → Data Loader → Composable → Component\n     (data)      (fetch/build)   (logic)    (presentation)\n```\n\nTasks:\n1. Create docs/.vitepress/theme/composables/useContentDetail.ts\n   - Move version formatter logic\n   - Add actionUrls computed (GitHub, Ansible Galaxy, Chef Supermarket)\n   - Add displayConfig for content-type specific rendering\n\n2. Rename ProfileDetail.vue → ContentDetail.vue\n   - Make it dumb/presentational\n   - Use composable for all logic\n\n3. Test with both validation and hardening profiles\n\nGIT STATUS:\n- Branch: main\n- Last commit: abba33c (pushed)\n- All changes committed and pushed\n\nKEY FILES:\n- docs/.vitepress/theme/components/ProfileDetail.vue (updated)\n- docs/validate/[slug].paths.ts (data loader)\n- docs/validate/[slug].md (template)\n- CLAUDE.md (layout pattern documented)\n\nNOTES:\n- Vue 3.5.25 with full composables support\n- VitePress data loaders run at build time (touch paths file to trigger rebuild)\n- Version convention: v2.5.3 = STIG V2R5, 3rd profile update","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-14T14:49:33.470343-05:00","created_by":"alippold","updated_at":"2026-01-14T15:15:46.394573-05:00","closed_at":"2026-01-14T15:15:46.394573-05:00","close_reason":"Context recovered in session 025"}
{"id":"saf-site-vitepress-576","title":"Export v2 database via sqlite-diffable","description":"Export Pocketbase database to git-friendly format for version control.\n\n## Commands\ncd .pocketbase/pb_data\nsqlite-diffable dump data.db diffable/ --all\n\n## Commit\ngit add .pocketbase/pb_data/diffable/\ngit commit -m 'feat: v2 schema with migrated data'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T11:19:39.464473-05:00","created_by":"alippold","updated_at":"2026-01-14T23:56:42.785189-05:00","closed_at":"2026-01-14T23:56:42.785189-05:00","close_reason":"v2 database exported to diffable/ and committed (d8d4435)","dependencies":[{"issue_id":"saf-site-vitepress-576","depends_on_id":"saf-site-vitepress-z95","type":"blocks","created_at":"2026-01-14T11:19:56.996119-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-5es","title":"Create apps showcase layout","description":"Build /apps landing page with app cards (Heimdall, Vulcan, SAF CLI). Similar to browse but with different card design.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T17:24:22.407154-05:00","created_by":"alippold","updated_at":"2026-01-12T17:24:22.407154-05:00"}
{"id":"saf-site-vitepress-5t9","title":"EPIC: Add Vitest testing infrastructure","description":"## Add Vitest Testing Infrastructure\n\n### Setup Tasks\n1. Install Vitest + @vue/test-utils + happy-dom\n2. Configure vitest.config.ts for VitePress environment\n3. Add test scripts to package.json\n4. Set up coverage reporting\n\n### Test Categories\n- **Unit tests**: Composables (useContentDetail, formatters)\n- **Component tests**: ProfileCard, ProfileFilters, ContentDetail\n- **Data loader tests**: Pocketbase queries, data transformation\n\n### References\n- Vitest: https://vitest.dev/\n- Vue Test Utils: https://test-utils.vuejs.org/\n- VitePress testing patterns (limited official docs)\n\n### Notes\n- Composables refactor (saf-site-vitepress-p80) will make testing easier\n- Test composable logic independently from components","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-14T15:18:44.403265-05:00","created_by":"alippold","updated_at":"2026-01-14T15:18:57.216791-05:00"}
{"id":"saf-site-vitepress-6a6","title":"RECOVERY: Session 018 Taxonomy Context","description":"SESSION 020 RECOVERY - 2026-01-14\n\nWORKFLOW: BEADS for task tracking, Pocketbase for content management\n\n## PROJECT CONTEXT\n\nVitePress POC for MITRE SAF site with Pocketbase content management.\nDesigning normalized 3NF schema v2 using TDD/BDD approach (peer review cycles).\n\n## COMPLETED THIS SESSION\n\n1. Database peer review Round 1 - identified gaps (4.0/5)\n2. Implemented fixes:\n   - Added slug fields to all 15 tables\n   - Added isFeatured, featuredOrder to content, tools, courses\n   - Added domain fields: controlCount, stigId, benchmarkVersion, automationLevel\n   - Added badgeColor to tags, isFree/priceUsd to courses\n   - Added indexes on all FK columns and filter fields\n   - Added cascadeDelete: true on all junction table relations\n3. Database peer review Round 2 - verified improvements (4.7/5 - Production Ready)\n4. Committed: 26e45b4\n\n## ROUND 3 TASKS (REMAINING SUGGESTIONS)\n\nAdd these fields/tables before running Round 3 peer review:\n\n### 1. courses table - add fields:\n```typescript\n// In schema-v2.ts, add to courses table:\nprerequisites: text('prerequisites'),           // Free text or comma-separated course slugs\ntargetAudience: text('target_audience'),        // \"developers\", \"security analysts\", \"devops\"\n```\n\n### 2. NEW releases table (version history):\n```typescript\nexport const releases = sqliteTable('releases', {\n  id: text('id').primaryKey(),\n  // Polymorphic: can track releases for content, tools, or distributions\n  entityType: text('entity_type').notNull(),    // 'content', 'tool', 'distribution'\n  entityId: text('entity_id').notNull(),        // FK to the entity\n  version: text('version').notNull(),\n  releaseDate: integer('release_date', { mode: 'timestamp' }),\n  releaseNotes: text('release_notes'),\n  downloadUrl: text('download_url'),\n  sha256: text('sha256'),                       // For verification\n  isLatest: integer('is_latest', { mode: 'boolean' }).default(false),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() =\u003e new Date())\n})\n```\n\n### 3. Update Pocketbase migration script to match\n\n## SCHEMA V2 STRUCTURE (CURRENT)\n\n**Lookup Tables (7):**\ncapabilities, categories, organizations, tags, tool_types, distribution_types, registries\n\n**Level 1 Tables (4):**\nteams, standards, technologies, targets\n\n**Main Content Tables (4):**\ncontent, tools, courses, distributions\n\n**Junction Tables (10):**\ncontent_capabilities, content_tags, content_relationships,\ntool_capabilities, tool_tags,\ndistribution_capabilities, distribution_tags,\ncourse_capabilities, course_tools, course_tags\n\n**Total: 25 collections** (will be 26 with releases table)\n\n## FILES TO EDIT\n\n1. docs/.vitepress/database/schema-v2.ts (Drizzle ORM)\n2. scripts/create-schema-v2-collections.ts (Pocketbase migration)\n\n## GIT STATUS\n\n- Branch: main\n- Last commit: 26e45b4\n- All changes committed and pushed\n\n## AFTER ROUND 3\n\n1. Test migration: npx tsx scripts/create-schema-v2-collections.ts\n2. Generate ERD diagram (Drismalizer recommended)\n3. Plan data migration from old schema\n4. Update VitePress data loaders\n\n## ERD TOOLS\n\n- Drismalizer: https://github.com/Honey2339/Drismalizer (web app, interactive)\n- Atlas: https://atlasgo.io/guides/orms/drizzle/visualize (production-grade)\n- drizzle-erd: https://github.com/rorz/drizzle-erd (simple CLI)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T19:06:48.371566-05:00","created_by":"alippold","updated_at":"2026-01-14T11:05:51.372274-05:00","closed_at":"2026-01-14T11:05:51.372274-05:00","close_reason":"Recovery card - v2 migration complete"}
{"id":"saf-site-vitepress-6c8","title":"Populate v2 lookup tables (tool_types, distribution_types, etc.)","description":"Add seed data to v2 lookup tables needed before adding distributions, courses, media.\n\n## Lookup Tables to Populate\n1. v2_tool_types: application, cli, library, extension, framework\n2. v2_distribution_types: helm_chart, npm_package, docker_image, binary, github_release\n3. v2_registries: Artifact Hub, Docker Hub, npmjs, GitHub Releases, PyPI\n4. v2_resource_types: video, article, documentation, internal_course, github_repo, youtube\n5. v2_media_types: presentation, pdf, video, webinar, conference_talk, tutorial\n\n## Method\n- Create seed script or use Pocketbase Admin UI\n- Document standard values in README","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T11:19:39.016729-05:00","created_by":"alippold","updated_at":"2026-01-14T11:19:39.016729-05:00","dependencies":[{"issue_id":"saf-site-vitepress-6c8","depends_on_id":"saf-site-vitepress-nzq","type":"blocks","created_at":"2026-01-14T11:19:56.545204-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-6cs","title":"PATTERN: Default full-width doc layout","description":"## Default Layout Pattern (Session 024)\n\nUse this layout for MOST pages on the site.\n\n### Frontmatter\n```yaml\n---\nlayout: doc\naside: false\n---\n```\n\n### Characteristics\n- Full-width doc layout without sidebar\n- Left-aligned content (not centered)\n- Consistent margins across site\n- Inherits VitePress doc typography\n\n### Use For\n- Browse/listing pages (validation profiles, hardening, apps)\n- Detail pages (profile details, tool details)\n- Framework pages\n- Any page that doesn't need TOC sidebar navigation\n\n### Exceptions (use standard doc WITH sidebar)\n- Documentation/guides that need TOC navigation\n- Blog posts with section navigation\n- Long-form content that benefits from outline\n\n### CSS Notes\n- Don't add max-width constraints to components\n- Let the doc layout control width for consistency\n- Components should fill available width\n\n### Reference\n- Browse page: `docs/validate/index.md`\n- Detail page: `docs/validate/[slug].md`\n- ProfileDetail component: no max-width, uses parent layout","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T14:20:20.866375-05:00","created_by":"alippold","updated_at":"2026-01-14T14:20:36.170502-05:00"}
{"id":"saf-site-vitepress-6rk","title":"Add pb-cli check to setup.sh","description":"Check for pb-cli installation and suggest install command","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-15T08:27:46.78772-05:00","created_by":"alippold","updated_at":"2026-01-15T08:30:47.082411-05:00","closed_at":"2026-01-15T08:30:47.082411-05:00","close_reason":"Added optional pb-cli check to prerequisites","dependencies":[{"issue_id":"saf-site-vitepress-6rk","depends_on_id":"saf-site-vitepress-3gm","type":"blocks","created_at":"2026-01-15T08:28:00.246559-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-76e","title":"Integrate Drizzle Studio for content editing","description":"## Drizzle Studio Integration - COMPLETED ✅\n\n**Solution:** Migrated from PGlite to SQLite with libsql client.\n\n**Current State:**\n- ✅ SQLite database with Drizzle ORM\n- ✅ Drizzle Studio works perfectly (all 12 tables visible)\n- ✅ libsql client (zero build dependencies, cross-platform)\n- ✅ sqlite-diffable integration for git-friendly exports\n- ✅ Complete contributor workflow ready\n\n**What Works:**\n- Visual editing via Drizzle Studio (localhost:4983)\n- Foreign key dropdowns in Studio\n- Schema validation\n- Round-trip: Studio → SQLite → dump → JSON → load → SQLite\n\n**Workflow:**\n1. `pnpm db:push` - Initialize database\n2. `pnpm studio` - Visual editor\n3. `pnpm db:dump` - Export to git-friendly JSON\n4. Commit diffable/ directory\n5. Other contributors: `pnpm db:load` - Import from JSON\n\n**Benefits Over PGlite:**\n- Works with Drizzle Studio (no compatibility issues)\n- Zero native compilation (better contributor experience)\n- Proven tooling (sqlite-diffable, 2+ years production)\n- Clean git diffs (JSON instead of binary)\n\n**Commits:**\n- 8895f4e: feat: migrate database from PGlite to SQLite\n- 980caba: feat: add sqlite-diffable for git-friendly database exports","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-12T19:26:15.574514-05:00","created_by":"alippold","updated_at":"2026-01-12T23:55:38.150257-05:00","closed_at":"2026-01-12T23:55:38.150257-05:00","close_reason":"Completed. Drizzle Studio working with SQLite + sqlite-diffable integration. Visual editing and git workflow ready."}
{"id":"saf-site-vitepress-7b0","title":"RECOVERY: Session 025 Context","description":"SESSION 025 RECOVERY - 2026-01-14\n\nWORKFLOW:\nThis project uses BEADS for task tracking. Content managed in Pocketbase, queried at build time.\n\nCOMPLETED THIS SESSION:\n- Fixed bd sync issue (removed VitePress cache from git tracking)\n- Improved .gitignore with standard patterns  \n- Set up Vitest testing infrastructure (39 tests passing)\n- Created useContentDetail.ts composable (version formatter, actionUrls, featureCards)\n- Created ContentDetail.vue component (uses composable)\n- ProfileDetail.vue now wraps ContentDetail for backwards compat\n- Fixed actionUrls logic: GitHub + README always, Documentation only if set\n- Cleared 82 bad documentation_url records from Pocketbase\n- Added reload-data script for dev workflow\n- Created LICENSE.md, README.md, CONTRIBUTING.md, CODE_OF_CONDUCT.md\n\nIN PROGRESS:\n- Root files created, need to commit\n\nKEY FILES MODIFIED:\n- docs/.vitepress/theme/composables/useContentDetail.ts (version formatter, action URLs)\n- docs/.vitepress/theme/composables/useContentDetail.spec.ts (20 tests)\n- docs/.vitepress/theme/components/ContentDetail.vue (new, uses composable)\n- docs/.vitepress/theme/components/ContentDetail.spec.ts (19 tests)\n- docs/.vitepress/theme/components/ProfileDetail.vue (wrapper for backwards compat)\n- vitest.config.ts (testing setup)\n- package.json (test scripts, reload-data)\n- LICENSE.md, README.md, CONTRIBUTING.md, CODE_OF_CONDUCT.md (root files)\n\nARCHITECTURE:\nPocketbase API → Data Loader → Composable → Component\n\nVERSION FORMATTER LOGIC:\n- STIG: 2.2.0 → V2R2 (V{major}R{minor})\n- CIS/Others: 2.0.0 → v2.0.0 (semver)\n\nACTION URLS LOGIC:\n- Always: View on GitHub, View README\n- If documentation_url exists: also show Documentation\n\nPOCKETBASE:\n- URL: http://127.0.0.1:8090\n- Admin: admin@localhost.com / testpassword123\n- Start: cd .pocketbase \u0026\u0026 ./pocketbase serve\n\nNEXT STEPS:\n1. Commit all session 025 work\n2. Close composables refactor task (saf-site-vitepress-p80)\n3. Continue with database population or browse pages\n\nRELATED BEADS:\n- saf-site-vitepress-p80: Composables refactor (DONE - close it)\n- saf-site-vitepress-5t9: Vitest testing epic (setup DONE)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-14T17:38:47.672099-05:00","created_by":"alippold","updated_at":"2026-01-14T22:42:51.38508-05:00","closed_at":"2026-01-14T22:42:51.38508-05:00","close_reason":"Context recovered from compaction"}
{"id":"saf-site-vitepress-7bi","title":"RECOVERY: Current Session Context","description":"SESSION 014 RECOVERY - 2026-01-13\n\nWORKFLOW:\nThis project uses BEADS for task tracking. See CLAUDE.md for VitePress development patterns.\n\nCOMPLETED THIS SESSION:\n- ✅ Fixed hardening YAML files (chef.yml, terraform.yml - changed profiles: to hardeningProfiles:)\n- ✅ Evaluated TrailBase vs Pocketbase for content management\n- ✅ REJECTED TrailBase: Poor schema handling, ER diagram broken, field types incorrect\n- ✅ APPROVED Pocketbase: FK UX validated with screenshot, version control viable\n- ✅ Researched correct Pocketbase API structure via agent (field options are DIRECT properties, not nested)\n- ✅ Created working Python script (scripts/create-collections-fixed.py)\n- ✅ Created test collections: organizations (3 records), profiles (1 record with FK)\n- ✅ Validated FK picker UX - shows organization NAMES in dropdown, searchable, inline editing\n- ✅ Confirmed sqlite-diffable approach for version control (same as libsql from session 013)\n\nCRITICAL DISCOVERY:\nPocketbase collection API structure - field properties are DIRECT, NOT nested in \"options\":\n```python\n{\n    \"name\": \"organization\",\n    \"type\": \"relation\",\n    \"collectionId\": org_id,      # DIRECT\n    \"cascadeDelete\": False,       # DIRECT\n    \"maxSelect\": 1                # DIRECT\n}\n```\n\nIN PROGRESS:\n- saf-site-vitepress-tay: Full Pocketbase implementation (Phase 1-5 plan)\n\nGIT STATUS:\n- Branch: main\n- Last commit: b07fdb9 (bd sync: 2026-01-13 00:18:40)\n- UNCOMMITTED WORK:\n  - content/data/hardening/chef.yml (hardeningProfiles key fixed)\n  - scripts/create-collections-fixed.py (working Python script)\n  - scripts/create-pocketbase-schema.py (Python with requests)\n  - scripts/delete-pocketbase-collections.ts (cleanup utility)\n  - scripts/test-relations.py, check-data.py, add-test-data.py\n  - .pocketbase/ directory (Pocketbase binary + test data)\n  - .gitignore updates\n\nPOCKETBASE STATE:\n- Installed: .pocketbase/pocketbase (v0.23.9)\n- Admin: admin@localhost.com / test1234567\n- Test collections exist: organizations (3 records), profiles (1 record)\n- Database: .pocketbase/pb_data/data.db\n\nNEXT STEPS (Priority Order):\n1. Commit current work (hardening fixes, Pocketbase setup, test scripts)\n2. Phase 1: Create all 12 collections with proper FK relations (30 mins)\n3. Phase 2: Import data using pb-cli (78 profiles, 18 standards, all reference data) (1 hour)\n4. Phase 3: Configure sqlite-diffable for version control (15 mins)\n5. Phase 4: Create CONTENT-EDITING.md documentation (15 mins)\n6. Phase 5: Update VitePress data loaders to read from Pocketbase (30 mins)\n\nBLOCKERS/NOTES:\n- Python SDK has parsing bugs but collections ARE created successfully (workaround: catch exceptions)\n- pb-cli recommended for Phase 2 import (avoids SDK issues)\n- All validation profiles have perfect data quality (0 duplicates, 0 missing fields)\n- Estimate: 2.5 hours total for full Pocketbase content management system\n\nKEY FILES:\n- scripts/create-collections-fixed.py - Working script with correct API structure\n- content/data/hardening/*.yml - Fixed hardeningProfiles key\n- saf-site-vitepress-tay - Full implementation plan card\n- YAML-STRUCTURE-DESIGN.md - Structure specification from agent analysis","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T12:30:00.293073-05:00","created_by":"alippold","updated_at":"2026-01-13T12:40:23.843255-05:00","closed_at":"2026-01-13T12:40:23.843255-05:00","close_reason":"Context recovered, ready to proceed with Pocketbase implementation"}
{"id":"saf-site-vitepress-91d","title":"EPIC: v1 Collection Cleanup","description":"Remove v1 collections, optionally rename v2 collections to drop prefix","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-15T08:28:08.689648-05:00","created_by":"alippold","updated_at":"2026-01-15T08:28:08.689648-05:00"}
{"id":"saf-site-vitepress-9et","title":"EPIC: CI/CD + PR Preview Deployments","description":"GitHub Actions workflow with Turborepo builds, PR preview deployments, auto-deploy on merge","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-15T08:39:49.521699-05:00","created_by":"alippold","updated_at":"2026-01-15T08:39:49.521699-05:00"}
{"id":"saf-site-vitepress-bj4","title":"Implement dynamic routes for profile detail pages","description":"## Implement Dynamic Routes for Profile Detail Pages\n\n**Goal:** Replace manual markdown files with dynamic route generation for validation profiles.\n\n**Current State:**\n- Manual files: `rhel8-stig.md`, `ubuntu-20-cis.md`, `windows-server-2019-stig.md`\n- Each profile needs a separate markdown file (doesn't scale)\n\n**Target State:**\n- Single template: `docs/validate/profiles/[slug].md`\n- Paths generator: `docs/validate/profiles/[slug].paths.ts`\n- Automatically generates pages for all profiles from YAML data\n\n**Implementation:**\n\n1. Create template file `docs/validate/profiles/[slug].md`:\n```vue\n---\nlayout: doc\n---\n\u003cscript setup\u003e\nimport { useData } from 'vitepress'\nconst { params } = useData()\n\u003c/script\u003e\n\n# {{ params.name }}\n\n{{ params.description }}\n\n- **Category:** {{ params.category }}\n- **Technology:** {{ params.technology }}\n- **Version:** {{ params.version }}\n- **Maintainer:** {{ params.maintainer }}\n\n[View on GitHub]({{ params.github_url }})\n```\n\n2. Create paths generator `docs/validate/profiles/[slug].paths.ts`:\n```typescript\nimport { data } from '../../.vitepress/loaders/profiles.data'\n\nexport default {\n  paths() {\n    return data.profiles.map(profile =\u003e ({\n      params: profile\n    }))\n  }\n}\n```\n\n3. Update browse page links to use new route structure\n4. Delete manual profile markdown files\n5. Test all routes work correctly\n\n**Benefits:**\n- Scales to 100+ profiles automatically\n- Single source of truth (YAML data)\n- Consistent page structure\n- Easy to update template for all pages\n\n**Reference:** VitePress Dynamic Routes docs","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-12T18:45:37.744352-05:00","created_by":"alippold","updated_at":"2026-01-14T14:04:24.214559-05:00","closed_at":"2026-01-14T14:04:24.214559-05:00","close_reason":"Implemented: [slug].paths.ts, [slug].md, ProfileDetail.vue"}
{"id":"saf-site-vitepress-bje","title":"SESSION 014 Recovery Context","description":"SESSION 013 RECOVERY - 2026-01-13\n\nWORKFLOW:\nThis project uses BEADS for task tracking. See CLAUDE.md for VitePress development patterns.\n\nCOMPLETED THIS SESSION:\n- ✅ Migrated from PGlite to SQLite (libsql client, zero build deps)\n- ✅ Drizzle Studio working perfectly (all 12 tables visible)\n- ✅ sqlite-diffable integration (git-friendly exports)\n- ✅ Copied YAML data from saf-site-v4 to content/data/\n- ✅ Fixed CIS standards bug (singular → plural array)\n- ✅ Created OTHER standard for miscellaneous profiles\n- ✅ Import script with timestamp normalization\n\nDATA QUALITY ISSUES DISCOVERED:\n1. **Standard ID mismatches:**\n   - Profiles reference \"PCI-DSS\" but database has \"pci-dss\"\n   - Need consistent ID normalization (lowercase-with-dashes)\n\n2. **Missing required fields:**\n   - Some profiles missing technology, organization, team\n   - FK references point to non-existent records\n\n3. **YAML structure bugs:**\n   - CIS standards file had \"standard:\" (singular) instead of \"standards:\" (plural array)\n   - Fixed in our copy at content/data/standards/cis.yml\n\nCURRENT STATE:\n- SQLite database: .data/saf.db (partial data loaded)\n- Schema: 12 tables with foreign keys\n- Data files: content/data/* (copied and partially fixed)\n- Import script: scripts/import-from-v4.ts (needs FK normalization)\n- Commits: 980caba (sqlite-diffable), 8895f4e (SQLite migration)\n\nNEXT SESSION PRIORITIES:\n1. **Fix data quality issues:**\n   - Add ID normalization mapping in import script (PCI-DSS → pci-dss, CIS → CIS)\n   - Set missing FKs to NULL instead of failing\n   - Add default values for missing technology/organization/team\n\n2. **Complete import:**\n   - Run full import successfully (all profiles, hardening, etc.)\n   - Verify data in Drizzle Studio (pnpm studio)\n   - Run pnpm db:dump to generate diffable/ JSON\n\n3. **Test workflow:**\n   - Edit data in Studio\n   - Dump to JSON (pnpm db:dump)\n   - Commit and check git diff\n   - Load from JSON (pnpm db:load)\n   - Verify round-trip works\n\nFILES MODIFIED (uncommitted):\n- content/data/ (entire directory copied and fixed)\n- content/data/standards/cis.yml (fixed structure)\n- content/data/standards/other.yml (created)\n- scripts/import-from-v4.ts (updated to use local files)\n- package.json (added tsx, db:import-v4 script)\n- pnpm-lock.yaml (tsx dependency)\n\nGIT STATUS:\n- Branch: main\n- Last push: 980caba\n- Unstaged: content/data/, scripts/, package.json, pnpm-lock.yaml\n- **DO NOT COMMIT YET** - import incomplete, data quality issues remain\n\nBLOCKERS/NOTES:\n- Import failing on FK constraint violations\n- Need to handle invalid FK references gracefully\n- Python dependency (sqlite-diffable) needs documentation for contributors","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T00:17:06.847802-05:00","created_by":"alippold","updated_at":"2026-01-13T00:23:46.492848-05:00","closed_at":"2026-01-13T00:23:46.492848-05:00","close_reason":"Context recovered, ready to continue data import work"}
{"id":"saf-site-vitepress-bn9","title":"RECOVERY: Current Session Context","description":"SESSION 016 RECOVERY - 2026-01-13\n\nWORKFLOW:\nThis project uses BEADS for task tracking. VitePress POC evaluating replacement for Nuxt site.\n\nPOCKETBASE ARCHITECTURE:\n- Pocketbase 0.23.9 is single source of truth (not YAML)\n- Database version-controlled via sqlite-diffable (NDJSON format)\n- VitePress data loaders query Pocketbase REST API at build time\n- Content workflow: Edit in Pocketbase → Export DB → Commit → Build\n\nCOMPLETED THIS SESSION:\n✅ Phase 5 VitePress Integration (partial - 1.5 hours)\n- Updated ARCHITECTURE.md: Pocketbase as single source of truth\n- Updated CLAUDE.md: Content management patterns, data loader patterns\n- Updated profiles.data.ts: Query Pocketbase API with authentication\n- Fixed ProfileFilters.vue: Dynamic categories/technologies from real data\n- Successfully tested: 78 profiles loaded from Pocketbase with FK expansion\n- Dev server running with real data, dropdowns populated from database\n\nKEY DISCOVERIES:\n- VitePress data loaders can query Pocketbase REST API at build time\n- Authentication required: pb.admins.authWithPassword() for build access\n- FK expansion works: expand: 'technology,organization,team,standard'\n- Filter dropdowns now dynamic: Extract unique categories/tech from profiles\n- Technology filtering uses technology_name (display name) not ID\n\nIN PROGRESS:\n- saf-site-vitepress-tay: Phase 5 VitePress data loader integration (75% done)\n  - ✅ profiles.data.ts queries Pocketbase API\n  - ✅ Dynamic filter dropdowns working\n  - ⏳ Need to test category filtering (Platform Security, etc.)\n  - ⏳ Need to test technology filtering\n  - ⏳ Need to test search functionality\n  - ⏳ Create data loaders for hardening_profiles, standards, tools\n\nGIT STATUS:\n- Branch: main\n- Last commit: 8ad6fbe (bd sync: 2026-01-13 14:36:25)\n- Uncommitted: ProfileFilters.vue, validate/index.md (dropdown fixes)\n- Test scripts: create-all-collections*.py (not needed in git)\n- Pocketbase running: http://localhost:8090 (78 profiles imported)\n\nPOCKETBASE STATE:\n- Running at http://localhost:8090 with admin@localhost.com / test1234567\n- 12 collections with proper FK relations\n- 78 validation profiles, 5 hardening profiles, all reference data\n- All data imported and accessible via API\n- Database exported to .pocketbase/pb_data/diffable/ (46 files)\n\nNEXT STEPS (Priority Order):\n1. Commit dropdown fixes (ProfileFilters.vue, validate/index.md)\n2. Test filtering by category (Platform Security, Cloud Platform, etc.)\n3. Test filtering by technology (should show unique tech names)\n4. Test search functionality\n5. Create hardening_profiles.data.ts loader\n6. Create standards.data.ts loader\n7. Update remaining browse pages with real data\n\nBLOCKERS/NOTES:\n- Dev server works perfectly with Pocketbase API\n- Dropdowns now populate from real data (15 categories, multiple techs)\n- Need to verify filtering logic works correctly (technology_name matching)\n- Total session time: ~2 hours (under 2.5 hour estimate for Phase 5)\n\nCRITICAL FILES:\n- docs/.vitepress/loaders/profiles.data.ts: Queries Pocketbase API\n- docs/.vitepress/theme/components/ProfileFilters.vue: Dynamic dropdowns\n- docs/validate/index.md: Browse page with filtering\n- ARCHITECTURE.md: Complete Pocketbase architecture documentation\n- CLAUDE.md: Content management and data loader patterns","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T14:51:44.885548-05:00","created_by":"alippold","updated_at":"2026-01-13T14:55:40.85115-05:00","closed_at":"2026-01-13T14:55:40.85115-05:00","close_reason":"Context recovered, continuing Phase 5 testing"}
{"id":"saf-site-vitepress-brg","title":"SESSION 014 Recovery Context","description":"SESSION 014 RECOVERY - 2026-01-13\n\nWORKFLOW:\nThis project uses BEADS for task tracking. See CLAUDE.md for VitePress development patterns.\n\nCOMPLETED THIS SESSION:\n- ✅ Migrated database from PGlite to SQLite (libsql - zero build deps)\n- ✅ Integrated sqlite-diffable for git-friendly DB exports\n- ✅ Created comprehensive data quality Python script (duplicate detection, missing fields, FK validation, structural validation)\n- ✅ Fixed all data quality issues: 66 normalizations, 0 duplicates, 0 missing fields, 4 profiles manually fixed\n- ✅ Successfully imported all data: 78 validation profiles, 18 standards, 16 orgs, 8 techs, 4 teams, 52 tags\n- ✅ Discovered structural inconsistency: hardening files use wrong top-level keys\n- ✅ Spawned agents to analyze YAML structure and create comprehensive design document (YAML-STRUCTURE-DESIGN.md)\n\nCRITICAL DISCOVERY - YAML Structure Issues:\n- hardening/terraform.yml and chef.yml use \"profiles:\" (WRONG)\n- Should use \"hardeningProfiles:\" like ansible.yml\n- This caused 0 hardening profiles to import\n- Need to fix before proceeding\n\nDATA QUALITY ACHIEVEMENTS:\n- NO duplicate IDs across all entities\n- NO missing required fields (fixed 4 profiles manually)\n- ALL FKs normalized and consistent\n- Explicit ID mapping hash (CIS→cis, STIG→stig, etc.)\n- Backups created with timestamps\n- .gitignore updated automatically\n\nIN PROGRESS:\n- beads-tfc: YAML import/export utilities (blocked by structure standardization)\n\nGIT STATUS:\n- Branch: main\n- Last commit: b07fdb9 (beads sync)\n- UNCOMMITTED WORK:\n  - scripts/fix-yaml-data-quality.py (comprehensive quality script)\n  - scripts/import-from-v4.ts (YAML→SQLite import)\n  - content/data/ (all YAML files with quality fixes applied)\n  - YAML-STRUCTURE-DESIGN.md (agent-generated design doc)\n  - .gitignore, package.json, pnpm-lock.yaml\n  - .beads/issues.jsonl\n\nNEXT STEPS (Priority Order):\n1. FIX CRITICAL: Update hardening/terraform.yml and chef.yml to use \"hardeningProfiles:\" key\n2. Update quality script to validate top-level keys match directory expectations\n3. Re-run validation + import to verify hardening profiles load (expect ~5-10 profiles)\n4. Commit all changes (quality script, import script, data files, design doc)\n5. DECISION NEEDED: Consider pocketbase vs current SQLite+Drizzle approach for CMS-like editing\n\nBLOCKERS/NOTES:\n- At 6% context - must compact after committing\n- Pocketbase discussion: Getting close to CMS territory but want to avoid external services/databases\n- Current approach: SQLite + Drizzle Studio + sqlite-diffable (all self-contained, no external services)\n- Hardening import broken until top-level keys fixed (0 profiles imported vs expected ~5-10)\n- DB Browser for SQLite has FK dropdowns but font size issues for user\n- Data quality is PERFECT except for the 2 hardening files needing key rename\n\nKEY FILES:\n- scripts/fix-yaml-data-quality.py - Comprehensive quality checker with 4 validation phases\n- scripts/import-from-v4.ts - YAML→SQLite import with timestamp normalization\n- YAML-STRUCTURE-DESIGN.md - Full specification from agent analysis\n- .data/saf.db - SQLite database with all imported data\n- content/data/ - Source YAML files (copied from saf-site-v4, quality-fixed)\n\nVALIDATION SCRIPT CAPABILITIES:\n- Duplicate ID detection across all entity types\n- Missing required field detection\n- FK reference validation with explicit mapping\n- Structural validation (YAML keys)\n- Timestamped backups before any changes\n- Auto-updates .gitignore\n- Validation-only mode (--validate)\n- Dry-run mode (default)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T09:47:10.16849-05:00","created_by":"alippold","updated_at":"2026-01-13T12:27:14.760198-05:00","closed_at":"2026-01-13T12:27:14.760198-05:00","close_reason":"Context recovered, Pocketbase decision made and validated"}
{"id":"saf-site-vitepress-c6s","title":"EPIC: Core Pages","description":"Main site structure: home page, framework pages, apps pages, docs structure and navigation.","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T17:23:50.070167-05:00","created_by":"alippold","updated_at":"2026-01-12T17:23:50.070167-05:00"}
{"id":"saf-site-vitepress-cei","title":"SESSION 011 Recovery Context","description":"SESSION 013 RECOVERY - 2026-01-13\n\nCOMPLETED THIS SESSION:\n- ✅ Migrated from PGlite to SQLite (libsql client, zero build deps)\n- ✅ Drizzle Studio working perfectly (all 12 tables visible)\n- ✅ sqlite-diffable integration (git-friendly exports)\n- ✅ Copied YAML data from saf-site-v4 to content/data/\n- ✅ Fixed CIS standards bug (singular → plural array)\n- ✅ Created OTHER standard for miscellaneous profiles\n- ✅ Import script with timestamp normalization\n\nDATA QUALITY ISSUES DISCOVERED:\n1. **Standard ID mismatches:**\n   - Profiles reference \"PCI-DSS\" but database has \"pci-dss\"\n   - Need consistent ID normalization (lowercase-with-dashes)\n\n2. **Missing required fields:**\n   - Some profiles missing technology, organization, team\n   - FK references point to non-existent records\n\n3. **YAML structure bugs:**\n   - CIS standards file had \"standard:\" (singular) instead of \"standards:\" (plural array)\n   - Fixed in our copy at content/data/standards/cis.yml\n\nCURRENT STATE:\n- SQLite database: .data/saf.db\n- Schema: 12 tables with foreign keys\n- Data files: content/data/* (copied and partially fixed)\n- Import script: scripts/import-from-v4.ts\n- Commits: 980caba (sqlite-diffable), 8895f4e (SQLite migration)\n\nNEXT SESSION PRIORITIES:\n1. **Fix data quality issues:**\n   - Normalize standard IDs (add mapping: PCI-DSS → pci-dss, etc.)\n   - Add missing technology/organization/team defaults\n   - Handle NULL FKs gracefully\n\n2. **Complete import:**\n   - Run full import successfully\n   - Verify data in Drizzle Studio\n   - Run pnpm db:dump to generate diffable/ JSON\n\n3. **Test workflow:**\n   - Edit data in Studio\n   - Dump to JSON\n   - Commit and check git diff\n   - Load from JSON\n   - Verify round-trip works\n\nFILES MODIFIED (uncommitted):\n- content/data/ (entire directory copied and fixed)\n- content/data/standards/cis.yml (fixed structure)\n- content/data/standards/other.yml (created)\n- scripts/import-from-v4.ts (updated to use local files)\n- package.json (added tsx, db:import-v4 script)\n\nGIT STATUS:\n- Branch: main\n- Last push: 980caba\n- Unstaged: content/data/, scripts/, package.json changes","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-12T17:33:48.169057-05:00","created_by":"alippold","updated_at":"2026-01-13T00:14:55.183048-05:00","closed_at":"2026-01-12T23:54:54.982891-05:00","close_reason":"Session recovered. Completed SQLite migration and sqlite-diffable integration. Database infrastructure ready for content editing."}
{"id":"saf-site-vitepress-dfg","title":"Set up asset directory structure","description":"## Set Up Asset Directory Structure\n\n**Goal:** Establish organized asset directory for images, icons, and downloadable files.\n\n**Target Structure:**\n```\ndocs/public/\n├── img/\n│   ├── logos/\n│   │   ├── mitre-saf.png (already exists)\n│   │   ├── mitre-saf-dark.png\n│   │   └── mitre-saf-icon.svg\n│   ├── icons/\n│   │   ├── linux.svg\n│   │   ├── windows.svg\n│   │   ├── cloud.svg\n│   │   └── database.svg\n│   └── badges/\n│       └── (future: status badges)\n└── downloads/\n    └── (future: PDF guides)\n```\n\n**Implementation:**\n\n1. Create directory structure in `docs/public/`\n2. Verify existing logo reference works: `/img/logos/mitre-saf.png`\n3. Add technology icons for Linux, Windows, Cloud, Database\n4. Update ProfileCard component to use icons if needed\n5. Document asset referencing pattern in code comments\n\n**Usage Pattern:**\n```vue\n\u003c!-- In components/markdown --\u003e\n\u003cimg src=\"/img/icons/linux.svg\" alt=\"Linux\"\u003e\n\n\u003c!-- In config --\u003e\nlogo: '/img/logos/mitre-saf.png'\n```\n\n**Key Rules:**\n- Use root-absolute paths: `/img/logo.png`\n- Don't include `/public/` in paths\n- VitePress handles hashing in production\n- Keep assets organized by type\n\n**Benefits:**\n- Organized asset management\n- Clear conventions for all developers\n- Easy to add new assets\n- Consistent paths across project","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T18:45:42.728528-05:00","created_by":"alippold","updated_at":"2026-01-12T18:45:42.728528-05:00"}
{"id":"saf-site-vitepress-dqt","title":"EPIC: Content Migration","description":"Get real data from saf-site-v4: copy YAML files, set up data loaders, generate individual detail pages.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-12T17:23:47.214903-05:00","created_by":"alippold","updated_at":"2026-01-14T11:07:10.10068-05:00","closed_at":"2026-01-14T11:07:10.10068-05:00","close_reason":"Superseded by v2 migration - data already migrated to Pocketbase","dependencies":[{"issue_id":"saf-site-vitepress-dqt","depends_on_id":"saf-site-vitepress-bj4","type":"blocks","created_at":"2026-01-12T18:46:01.134304-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-dqt","depends_on_id":"saf-site-vitepress-l7u","type":"blocks","created_at":"2026-01-12T18:46:10.917929-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-dst","title":"Create framework page layout","description":"Build framework pages (Plan, Harden, Validate, Normalize, Visualize). Use layout: doc with proper typography and prose styling.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T17:24:19.502611-05:00","created_by":"alippold","updated_at":"2026-01-12T17:24:19.502611-05:00"}
{"id":"saf-site-vitepress-eiz","title":"Document pb-cli in README.md","description":"Add pb-cli to Commands section and explain backup workflow","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-15T08:27:40.837432-05:00","created_by":"alippold","updated_at":"2026-01-15T08:29:22.703791-05:00","closed_at":"2026-01-15T08:29:22.703791-05:00","close_reason":"Added pb-cli backup section with commands and setup instructions","dependencies":[{"issue_id":"saf-site-vitepress-eiz","depends_on_id":"saf-site-vitepress-3gm","type":"blocks","created_at":"2026-01-15T08:28:00.02422-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-ga0","title":"HUB: SAF Site Architecture Overview","description":"SAF SITE VITEPRESS - PROJECT ARCHITECTURE HUB\n\nTECH STACK:\n- VitePress 1.6.4 (static site generator)\n- Vue 3.5 with Composition API\n- Pocketbase 0.23.9 (content database - needs upgrade to 0.35.1)\n- Reka UI 2.7.0 (headless components)\n- Vitest 4 (testing)\n- pnpm 10.x (package manager)\n- sqlite-diffable (database version control)\n\nARCHITECTURE PATTERN:\nBuild-time data loading - Pocketbase runs locally, VitePress queries API during build, outputs static HTML. No runtime database.\n\nDATA FLOW:\n1. Content edited in Pocketbase Admin UI (localhost:8090/_/)\n2. VitePress data loaders query Pocketbase API at build time\n3. Static HTML generated with embedded data\n4. Deployed as static site (no server needed)\n\nVERSION CONTROL:\n- Database binary (data.db) is gitignored\n- sqlite-diffable exports to diffable/ directory (NDJSON format)\n- diffable/ is git-tracked - this IS the source of truth\n- pnpm setup restores database from diffable/\n\nSCHEMA VERSIONS:\n- v1: Original schema (profiles, hardening_profiles, tags, etc.)\n- v2: New unified schema with 33 collections (v2_ prefix)\n- Both coexist - v2 will eventually replace v1\n\nKEY DIRECTORIES:\n- docs/.vitepress/loaders/ - Build-time data loaders\n- docs/.vitepress/theme/components/ - Vue components\n- docs/.vitepress/theme/composables/ - Vue logic extraction\n- .pocketbase/pb_data/diffable/ - Git-tracked database\n- scripts/ - Setup, migration, and utility scripts\n\nSPOKE CARDS (read as needed):\n- Database workflow: bd show saf-site-vitepress-35u\n- Testing patterns: (to be created)\n- Component patterns: (to be created)","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-15T07:15:41.56382-05:00","created_by":"alippold","updated_at":"2026-01-15T07:16:40.409921-05:00"}
{"id":"saf-site-vitepress-ik5","title":"EPIC: Production Deployment","description":"Production hosting setup, secrets management, domain configuration","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-15T08:39:56.151475-05:00","created_by":"alippold","updated_at":"2026-01-15T08:39:56.151475-05:00"}
{"id":"saf-site-vitepress-irc","title":"Cleanup: Remove v1 collections and rename v2","description":"After v2 is validated and stable, remove v1 collections and rename v2 to final names.\n\n## Steps\n1. Verify all VitePress loaders use v2_* collections\n2. Verify site builds and works correctly\n3. Delete v1 collections via Admin UI or API\n4. Rename v2_* collections (remove prefix)\n5. Update VitePress loaders to use final names\n6. Re-export database\n\n## Risk: Low\n- Pocketbase FKs use IDs not names, so renaming is safe\n- Keep v1 until fully validated","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-14T11:19:39.586424-05:00","created_by":"alippold","updated_at":"2026-01-14T11:19:39.586424-05:00","dependencies":[{"issue_id":"saf-site-vitepress-irc","depends_on_id":"saf-site-vitepress-576","type":"blocks","created_at":"2026-01-14T11:19:57.115565-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-l7u","title":"Expand data loaders for all content types","description":"## Expand Data Loaders for All Content Types\n\n**Goal:** Create data loaders for hardening guides, standards, and frameworks (not just validation profiles).\n\n**Current State:**\n- ✅ Validation profiles loader: `docs/.vitepress/loaders/profiles.data.ts`\n- ❌ No loaders for other content types\n\n**Target State:**\n```\ndocs/.vitepress/loaders/\n├── profiles.data.ts (exists)\n├── hardening.data.ts (new)\n├── standards.data.ts (new)\n└── frameworks.data.ts (new)\n```\n\n**Implementation:**\n\n1. **Hardening Guides Loader** (`hardening.data.ts`):\n```typescript\nimport { defineLoader } from 'vitepress'\n\ninterface HardeningGuide {\n  id: string\n  slug: string\n  name: string\n  description: string\n  platform: string\n  version: string\n  github_url: string\n}\n\nexport default defineLoader({\n  watch: ['../../content/data/hardening/*.yml'],\n  async load(): Promise\u003c{ guides: HardeningGuide[] }\u003e {\n    // Load and parse YAML files\n    // Return typed data\n  }\n})\n```\n\n2. **Standards Loader** (`standards.data.ts`):\n```typescript\ninterface Standard {\n  id: string\n  slug: string\n  name: string\n  organization: string\n  description: string\n  url: string\n}\n\nexport default defineLoader({\n  watch: ['../../content/data/standards/*.yml'],\n  async load(): Promise\u003c{ standards: Standard[] }\u003e {\n    // Load standards data\n  }\n})\n```\n\n3. **Frameworks Loader** (`frameworks.data.ts`):\n```typescript\ninterface Framework {\n  id: string\n  name: string\n  phases: string[]\n  description: string\n}\n\nexport default defineLoader({\n  watch: ['../../content/data/frameworks/*.yml'],\n  async load(): Promise\u003c{ frameworks: Framework[] }\u003e {\n    // Load framework data\n  }\n})\n```\n\n**Testing:**\n- Import data in components to verify types\n- Check hot-reload works when YAML changes\n- Verify build-time data transformation\n\n**Benefits:**\n- Consistent data loading pattern\n- Type-safe imports everywhere\n- Single source of truth (YAML files)\n- Hot-reload during development\n- Ready for dynamic route generation\n\n**Dependency:** Requires YAML data from saf-site-v4 (Content Migration epic)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-12T18:45:46.90197-05:00","created_by":"alippold","updated_at":"2026-01-14T11:07:09.97202-05:00","closed_at":"2026-01-14T11:07:09.97202-05:00","close_reason":"Outdated - now using Pocketbase v2 collections, not YAML","dependencies":[{"issue_id":"saf-site-vitepress-l7u","depends_on_id":"saf-site-vitepress-m6x","type":"blocks","created_at":"2026-01-12T19:46:42.072302-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-m6x","title":"Create YAML file validation schemas (Zod)","description":"## Create YAML File Validation Schemas\n\n**Goal:** Build Zod schemas to validate YAML file structure (wrapper + arrays).\n\n**Location:** `docs/.vitepress/database/yaml-schemas.ts`\n\n**Problem:**\n- Database schema defines individual rows (Profile, HardeningProfile, etc.)\n- YAML files have wrapper structure (_id, _metadata, array of items)\n- Need to validate YAML file format when loading\n\n**Pattern:**\n```typescript\nimport { z } from 'zod'\nimport { insertProfileSchema, insertHardeningProfileSchema } from './schema'\n\n// Validation Profiles YAML File\nexport const ProfilesFileSchema = z.object({\n  _id: z.string(),\n  _metadata: z.object({\n    standard: z.string().optional(),\n    description: z.string().optional()\n  }).optional(),\n  profiles: z.array(insertProfileSchema)  // Reuse drizzle-zod schema\n})\n\nexport type ProfilesFile = z.infer\u003ctypeof ProfilesFileSchema\u003e\n\n// Hardening Profiles YAML File\nexport const HardeningFileSchema = z.object({\n  _id: z.string(),\n  _metadata: z.object({\n    framework: z.string().optional(),\n    technology: z.string().optional(),\n    description: z.string().optional(),\n    lastUpdated: z.string().optional(),\n    team: z.string().optional(),\n    organization: z.string().optional(),\n    logo: z.string().optional()\n  }).optional(),\n  profiles: z.array(insertHardeningProfileSchema)\n})\n\nexport type HardeningFile = z.infer\u003ctypeof HardeningFileSchema\u003e\n\n// Standards, Organizations, Teams, etc.\n// ... similar pattern for each YAML file type\n```\n\n**Usage in Data Loaders:**\n```typescript\nimport { parse } from 'yaml'\nimport { ProfilesFileSchema } from '../database/yaml-schemas'\n\nexport default defineLoader({\n  async load() {\n    const content = await readFile('profiles/stig.yml', 'utf-8')\n    const parsed = parse(content)\n    \n    // Validate YAML structure\n    const validated = ProfilesFileSchema.parse(parsed)\n    \n    return { profiles: validated.profiles }\n  }\n})\n```\n\n**Files to Create Schemas For:**\n- profiles/*.yml → ProfilesFileSchema\n- hardening/*.yml → HardeningFileSchema\n- standards/*.yml → StandardsFileSchema\n- organizations/*.yml → OrganizationsFileSchema\n- teams/*.yml → TeamsFileSchema\n- tools/*.yml → ToolsFileSchema\n- technologies/*.yml → TechnologiesFileSchema\n- tags/*.yml → TagsFileSchema\n\n**Benefits:**\n- Runtime validation of YAML format\n- Type-safe YAML loading\n- Reuses drizzle-zod schemas for individual items\n- Catches malformed YAML at build time\n\n**Dependencies:** Requires schema.ts (saf-site-vitepress-sc2)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-12T19:46:28.962175-05:00","created_by":"alippold","updated_at":"2026-01-12T19:55:32.654679-05:00","closed_at":"2026-01-12T19:55:32.654679-05:00","close_reason":"Closed","dependencies":[{"issue_id":"saf-site-vitepress-m6x","depends_on_id":"saf-site-vitepress-sc2","type":"blocks","created_at":"2026-01-12T19:46:41.831558-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-mk8","title":"EPIC: Content Management \u0026 Schema","description":"Self-sufficient content management: Port schema.ts (Drizzle + Zod) from saf-site-v4, YAML import/export utilities, external Zod Studio for editing. VitePress must be able to manage its own content.","status":"closed","priority":0,"issue_type":"epic","created_at":"2026-01-12T19:10:23.119905-05:00","created_by":"alippold","updated_at":"2026-01-14T11:05:51.493924-05:00","closed_at":"2026-01-14T11:05:51.493924-05:00","close_reason":"Superseded by v2 schema epic (saf-site-vitepress-nzq)","dependencies":[{"issue_id":"saf-site-vitepress-mk8","depends_on_id":"saf-site-vitepress-sc2","type":"blocks","created_at":"2026-01-12T19:14:34.58435-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-mk8","depends_on_id":"saf-site-vitepress-tfc","type":"blocks","created_at":"2026-01-12T19:23:38.749758-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-mtm","title":"RECOVERY: Session 022+ Context","description":"SESSION 022+ RECOVERY - 2026-01-14\n\nWORKFLOW:\nThis project uses BEADS for task tracking and Pocketbase for content management.\nKey project context card: bd show saf-site-vitepress-33i\n\nPOCKETBASE CRITICAL INFO:\n- URL: http://127.0.0.1:8090\n- Admin: admin@localhost.com / testpassword123\n- PocketBase 0.23+ uses _superusers for auth (NOT admins API)\n- Start: cd .pocketbase \u0026\u0026 ./pocketbase serve\n\nCOMPLETED THIS SESSION:\n1. Updated VitePress data loader for v2 schema\n   - Uses pb.collection('_superusers').authWithPassword() for PB 0.23+\n   - Queries v2_content with filter content_type=\"validation\"\n   - Expands: target, standard, technology, vendor, maintainer\n   \n2. Updated ProfileFilters.vue for v2 fields\n   - Replaced category/platform with target filter\n   - Uses target_name, technology_name, vendor_name, standard_name\n   \n3. Updated ProfileCard.vue with new features\n   - Status badge (green=active, yellow=beta, red=deprecated, gray=draft)\n   - Version in footer\n   - Short standard names (STIG vs full name)\n   \n4. Added short_name to v2_standards\n   - Schema updated: Pocketbase, create-schema-v2-collections.ts, schema-v2.ts (Drizzle)\n   - Populated all 18 standards with short names (STIG, CIS, CMMC, etc.)\n\n5. Documented PocketBase 0.23+ API changes in CLAUDE.md\n\nIN PROGRESS:\n- User wanted to add org/team owner to card (mentioned but not started)\n\nGIT STATUS:\n- Branch: main\n- Uncommitted changes: loader, components, schema files, CLAUDE.md\n- Need to commit before compact\n\nNEXT STEPS (AGREED PRIORITY ORDER):\n1. Database population work (fill in new data)\n   - Use saf.mitre.org and SAF training site as references\n   - User will provide links\n2. Populate v2 lookup tables (bd show saf-site-vitepress-6c8)\n3. Export database via sqlite-diffable (bd show saf-site-vitepress-576)\n4. Then move to pages/layouts\n\nKEY FILES MODIFIED:\n- docs/.vitepress/loaders/profiles.data.ts\n- docs/.vitepress/theme/components/ProfileCard.vue\n- docs/.vitepress/theme/components/ProfileFilters.vue\n- docs/validate/index.md\n- scripts/create-schema-v2-collections.ts\n- docs/.vitepress/database/schema-v2.ts\n- CLAUDE.md\n\nBLOCKERS/NOTES:\n- User was frustrated earlier - I kept jumping ahead instead of following agreed order\n- Lesson: Follow the work order, finish what's started before moving on\n- Database work first, then loaders, then pages (agreed priority)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-14T12:05:47.445341-05:00","created_by":"alippold","updated_at":"2026-01-14T12:25:49.74444-05:00","closed_at":"2026-01-14T12:25:49.74444-05:00","close_reason":"Context recovered"}
{"id":"saf-site-vitepress-myi","title":"Document pb-cli in CONTRIBUTING.md","description":"Add pb-cli usage for contributors","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-15T08:27:43.88665-05:00","created_by":"alippold","updated_at":"2026-01-15T08:29:58.283735-05:00","closed_at":"2026-01-15T08:29:58.283735-05:00","close_reason":"Added pb-cli section with install, setup, and common operations","dependencies":[{"issue_id":"saf-site-vitepress-myi","depends_on_id":"saf-site-vitepress-3gm","type":"blocks","created_at":"2026-01-15T08:28:00.135392-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-npl","title":"Document browse page pattern","description":"## Browse Page Pattern\n\n**Purpose**: Full-width listing pages with filters, search, and interactive Vue components while maintaining VitePress doc typography.\n\n### Frontmatter Configuration\n\n```yaml\n---\ntitle: Page Title\nlayout: doc      # Use doc layout for proper typography (NOT page layout)\naside: false     # Disable TOC sidebar for full-width content\n---\n```\n\n**Why `layout: doc`?**\n- `layout: page` gives blank canvas with NO typography (h1, p tags are unstyled)\n- `layout: doc` provides proper VitePress typography but is narrow (688px default)\n- Solution: Use `doc` layout + override width constraints with CSS\n\n### CSS Overrides (in `docs/.vitepress/theme/custom.css`)\n\n```css\n/* Full-width doc layout for browse pages */\n.VPDoc .container {\n  max-width: 1400px !important;\n}\n\n.VPDoc .content {\n  max-width: none !important;\n}\n\n.VPDoc .content-container {\n  max-width: none !important;\n}\n```\n\nThese overrides apply globally to ALL pages using `layout: doc`, so any page with `aside: false` gets full width automatically.\n\n### Interactive Browse Page Structure\n\n**Example**: `docs/validate/index.md`\n\n1. **Vue Script Setup** (client-side reactivity):\n```vue\n\u003cscript setup\u003e\nimport { ref, computed } from 'vue'\nimport { data } from '../.vitepress/loaders/profiles.data'\n\nconst allProfiles = data.profiles\nconst selectedCategory = ref('all')\nconst filteredProfiles = computed(() =\u003e {\n  // Filter logic here\n})\n\u003c/script\u003e\n```\n\n2. **Data Loading** (build-time):\n- Use VitePress data loaders: `docs/.vitepress/loaders/profiles.data.js`\n- Data is loaded at build time and imported as static data\n- Client-side Vue handles filtering/search on the loaded data\n\n3. **Component Usage**:\n```vue\n\u003cProfileFilters @update:category=\"selectedCategory = $event\" /\u003e\n\u003cProfileCard v-for=\"profile in filteredProfiles\" :key=\"profile.id\" :profile=\"profile\" /\u003e\n```\n\n4. **Scoped Styles**:\n```vue\n\u003cstyle scoped\u003e\n.profile-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));\n  gap: 1.5rem;\n}\n\u003c/style\u003e\n```\n\n### When to Use This Pattern\n\nUse for:\n- ✅ Listing pages with filters (profiles, guides, apps)\n- ✅ Browse/catalog pages with search\n- ✅ Pages needing full-width card grids\n- ✅ Pages with client-side interactivity\n\nDon't use for:\n- ❌ Content-heavy documentation pages (use default `layout: doc` with sidebar)\n- ❌ Simple static pages (use `layout: page` if no typography needed)\n\n### Pattern Benefits\n\n1. **Typography**: Proper h1, h2, p styling from VitePress theme\n2. **Full-width**: Maximum screen real estate for grids\n3. **Interactive**: Client-side Vue reactivity works seamlessly\n4. **Performance**: Data loaded at build time, filters run client-side\n5. **Consistency**: Same pattern across all browse pages","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-12T17:24:16.742049-05:00","created_by":"alippold","updated_at":"2026-01-12T17:41:00.643815-05:00","closed_at":"2026-01-12T17:41:00.643815-05:00","close_reason":"Closed"}
{"id":"saf-site-vitepress-nzq","title":"EPIC: v2 Schema Stabilization \u0026 Data Population","description":"Complete v2 database schema migration, populate lookup tables, add new content types (distributions, courses, media), integrate with VitePress, and prepare for production.\n\n## Completed\n- ✅ 28 v2 collections created with proper indexes\n- ✅ v1 data migrated (78 profiles, 5 hardening, 7 tools, 16 orgs, 52 tags, etc.)\n- ✅ Categories and targets auto-generated from profiles\n- ✅ Junction tables populated (117 content-tags, 4 relationships)\n\n## Remaining Work\n1. VitePress Integration - validate v2 collections work\n2. Lookup Table Population - tool_types, distribution_types, registries, etc.\n3. Main Content Population - distributions, courses, media\n4. Database Export - sqlite-diffable for git\n5. Cleanup - remove v1, rename v2 (later)\n\n## Key Files\n- scripts/create-schema-v2-collections.ts\n- scripts/migrate-v1-to-v2.ts\n- docs/.vitepress/database/schema-v2.ts\n- docs/.vitepress/database/README.md","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-14T11:05:30.091564-05:00","created_by":"alippold","updated_at":"2026-01-14T11:05:30.091564-05:00"}
{"id":"saf-site-vitepress-p80","title":"Refactor ProfileDetail to composables pattern","description":"## Refactor ProfileDetail to Composables Pattern\n\n### Architecture\n```\nPocketbase API → Data Loader → Composable → Component\n     (data)      (fetch/build)   (logic)    (presentation)\n```\n\n### Tasks\n1. Create `docs/.vitepress/theme/composables/useContentDetail.ts`\n   - Move version formatter logic\n   - Add actionUrls computed (GitHub, Ansible Galaxy, Chef Supermarket, Terraform Registry)\n   - Add displayConfig for content-type specific rendering\n\n2. Rename `ProfileDetail.vue` → `ContentDetail.vue`\n   - Make it dumb/presentational\n   - Use composable for all logic\n\n3. Update data loader to pass content_type\n4. Test with both validation and hardening profiles\n\n### Reference\n- Current component: `docs/.vitepress/theme/components/ProfileDetail.vue`\n- Backup of Option A: `ProfileDetail.vue.option-a.bak` (can delete)\n- Vue 3.5.25 with full composables support","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T14:45:16.775385-05:00","created_by":"alippold","updated_at":"2026-01-14T17:40:17.263606-05:00","closed_at":"2026-01-14T17:40:17.263606-05:00","close_reason":"Composables refactor complete with tests"}
{"id":"saf-site-vitepress-pd9","title":"Add distributions for SAF tools","description":"Add distribution records linking tools to their package releases.\n\n## Distributions to Add\n- SAF CLI: npm (@mitre/saf), Homebrew\n- Heimdall: Docker (mitre/heimdall2), npm, Helm chart\n- Vulcan: Docker\n- emasser: npm, gem\n\n## Fields\n- tool (FK), distribution_type (FK), registry (FK)\n- install_command, registry_url, version","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T11:19:39.12396-05:00","created_by":"alippold","updated_at":"2026-01-14T11:19:39.12396-05:00","dependencies":[{"issue_id":"saf-site-vitepress-pd9","depends_on_id":"saf-site-vitepress-6c8","type":"blocks","created_at":"2026-01-14T11:19:56.659821-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-qli","title":"Add pb-cli scripts to package.json","description":"Add db:backup, db:backup:list, db:backup:restore scripts","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-15T08:27:37.827657-05:00","created_by":"alippold","updated_at":"2026-01-15T08:28:48.945094-05:00","closed_at":"2026-01-15T08:28:48.945094-05:00","close_reason":"Added db:backup, db:backup:list, db:backup:download, db:backup:restore scripts","dependencies":[{"issue_id":"saf-site-vitepress-qli","depends_on_id":"saf-site-vitepress-3gm","type":"blocks","created_at":"2026-01-15T08:27:59.909847-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-sc2","title":"Port Drizzle + Zod schema from saf-site-v4","description":"## Port Drizzle + Zod Schema from saf-site-v4\n\n**Goal:** Copy complete schema definition to establish data structure and validation.\n\n**Source:** `/Users/alippold/github/mitre/saf-site-v4/app/database/schema.ts`\n\n**Target:** `docs/.vitepress/database/schema.ts`\n\n**What to Copy:**\n- Complete Drizzle schema (tables, relations)\n- Zod schemas (createInsertSchema, createSelectSchema)\n- TypeScript type exports\n\n**Tables:**\n- tags\n- organizations\n- teams\n- technologies\n- standards\n- profiles (validation)\n- hardeningProfiles\n- tools\n- capabilities\n- Junction tables (profilesTags, validationToHardening, etc.)\n\n**Relations:**\n- All Drizzle relations for type-safe joins\n\n**Zod Schemas:**\n- Insert/Select schemas for all tables\n- Runtime validation\n\n**TypeScript Types:**\n- Type exports using $inferSelect/$inferInsert\n\n**Testing:**\n- Import schema in data loader\n- Verify types work in TypeScript\n- Test Zod validation with sample data\n\n**Dependencies:** None (first task in Content Management)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-12T19:14:34.367479-05:00","created_by":"alippold","updated_at":"2026-01-14T11:05:51.131677-05:00","closed_at":"2026-01-14T11:05:51.131677-05:00","close_reason":"Superseded by v2 schema (schema-v2.ts) - migration complete"}
{"id":"saf-site-vitepress-tay","title":"SESSION 015: Pocketbase Content Management Implementation","description":"# Pocketbase Content Management - Implementation Plan\n\n## DECISION MADE: Pocketbase is APPROVED\n\n**Why**: FK relation UX tested and validated - shows organization NAMES in picker, searchable, inline editing, good UX for managing ~100 profiles with relationships.\n\n**Critical Requirement Met**: Pocketbase SQLite database can be version controlled using sqlite-diffable (same as libsql approach from session 013).\n\n## CURRENT STATUS\n\n### Completed (Session 014)\n- ✅ Evaluated TrailBase vs Pocketbase (TrailBase rejected - poor schema handling)\n- ✅ Researched correct Pocketbase API structure (field options are DIRECT properties, not nested in \"options\")\n- ✅ Created working Python script that creates collections with proper field structure\n- ✅ Created test collections: organizations (with 3 test records), profiles (with FK to organizations)\n- ✅ Validated FK picker UX with screenshot - APPROVED by user\n- ✅ Confirmed sqlite-diffable approach works for version control\n\n### Technical Discovery - Pocketbase Collection API\n\n**Key insight from agent research**: Field-specific properties are DIRECT on field object, NOT nested in \"options\":\n\n```python\n{\n    \"name\": \"organization\",\n    \"type\": \"relation\",\n    \"required\": False,\n    \"collectionId\": org_id,      # DIRECT property\n    \"cascadeDelete\": False,       # DIRECT property\n    \"maxSelect\": 1                # DIRECT property\n}\n```\n\n**NOT**:\n```python\n{\n    \"name\": \"organization\",\n    \"type\": \"relation\",\n    \"options\": {  # WRONG!\n        \"collectionId\": org_id\n    }\n}\n```\n\n### Working Script\n`scripts/create-collections-fixed.py` - Creates collections with correct structure. Python SDK has parsing bugs reading responses but collections ARE created successfully.\n\n### Current Pocketbase State\n- Running at: http://localhost:8090\n- Admin: admin@localhost.com / test1234567\n- Test collections exist: organizations (3 records), profiles (1 record with FK)\n- Location: `.pocketbase/pb_data/data.db`\n\n## NEXT SESSION PLAN\n\n### Phase 1: Create Full Schema (30 mins)\n\nCreate all 12 collections with proper FK relations:\n\n**Base Collections** (no FKs):\n1. tags\n2. organizations  \n3. technologies\n4. standards\n5. capabilities\n\n**Collections with FKs**:\n6. teams (FK: organization)\n7. profiles (FKs: technology, organization, team, standard)\n8. hardening_profiles (FKs: technology, organization, team, standard)\n9. tools (FKs: technology, organization)\n\n**Junction Tables** (many-to-many):\n10. profiles_tags\n11. hardening_profiles_tags\n12. validation_to_hardening\n\n**Script to create**: Extend `scripts/create-collections-fixed.py` with all 12 collections using the correct field structure.\n\n### Phase 2: Import Data (1 hour)\n\nImport existing data from `content/data/*.yml`:\n- 78 validation profiles\n- 18 standards\n- 16 organizations\n- 8 technologies\n- 4 teams\n- 52 tags\n- 7 tools\n- 5 capabilities\n\n**Approach**: Reuse `scripts/import-from-v4.ts` logic but adapt for Pocketbase Python SDK.\n\n**Handle**: \n- YAML normalization (use existing quality fixes)\n- FK resolution (map IDs correctly)\n- Timestamp conversion\n- Hardening profiles structure (validationProfiles vs hardeningProfiles keys)\n\n### Phase 3: Version Control Setup (15 mins)\n\nConfigure sqlite-diffable for Pocketbase database:\n\n```bash\n# Export Pocketbase DB to git-friendly format\ncd .pocketbase/pb_data\nsqlite-diffable dump data.db\n\n# Creates:\n# - data.db.metadata.json (schema)\n# - data.db.ndjson (data)\n```\n\n**Update .gitignore**:\n```\n.pocketbase/pb_data/data.db\n.pocketbase/pb_data/data.db-wal\n.pocketbase/pb_data/data.db-shm\n.pocketbase/pb_data/logs.db*\n.pocketbase/pb_data/storage/\n```\n\n**Add to git**:\n```\ngit add .pocketbase/pb_data/data.db.metadata.json\ngit add .pocketbase/pb_data/data.db.ndjson\n```\n\n### Phase 4: Documentation (15 mins)\n\nCreate `CONTENT-EDITING.md`:\n- How to start Pocketbase\n- How to edit content in UI\n- How to export changes with sqlite-diffable\n- How to commit changes\n- How other devs restore the DB\n\n### Phase 5: VitePress Integration (30 mins)\n\nUpdate VitePress data loaders to read from Pocketbase:\n\n**Option A**: Export Pocketbase → JSON files, VitePress reads JSON (simple, works with existing loaders)\n\n**Option B**: VitePress data loaders query Pocketbase REST API directly (requires Pocketbase running during build)\n\n**Recommend Option A** for simplicity and build-time performance.\n\n## CRITICAL FILES\n\n### Working Scripts\n- `scripts/create-collections-fixed.py` - Creates collections with correct field structure\n- `scripts/delete-pocketbase-collections.ts` - Cleanup utility\n- `scripts/check-data.py` - Verify data exists\n- `scripts/test-relations.py` - Original test script\n\n### Data Sources\n- `content/data/profiles/*.yml` - 78 validation profiles\n- `content/data/hardening/*.yml` - Hardening profiles (need structure fix)\n- `content/data/standards/*.yml` - 18 standards\n- `content/data/organizations/*.yml` - 16 organizations\n- `content/data/technologies/*.yml` - 8 technologies\n\n### Quality Validation\n- `scripts/fix-yaml-data-quality.py` - Comprehensive validation (66 normalizations applied)\n- `YAML-STRUCTURE-DESIGN.md` - Structure specification from agent analysis\n\n## KNOWN ISSUES\n\n1. **Python SDK parsing bug**: SDK throws TypeError when reading relation field responses. WORKAROUND: Catch exception - collections ARE created successfully despite error.\n\n2. **Hardening profiles structure**: `hardening/terraform.yml` and `chef.yml` use wrong key (`profiles:` instead of `hardeningProfiles:`). Fixed in content/data but needs verification.\n\n3. **Data quality**: All validation profiles have perfect data quality (0 duplicates, 0 missing fields, all FKs normalized). Hardening profiles need import testing.\n\n## SUCCESS CRITERIA\n\n- [ ] All 12 collections created with proper schema\n- [ ] All 78 validation profiles imported with correct FK references\n- [ ] Organizations/standards/technologies/teams/tags imported\n- [ ] Hardening profiles imported and linked to validation profiles\n- [ ] FK dropdowns show names (not IDs) in Pocketbase UI\n- [ ] sqlite-diffable configured and tested\n- [ ] Changes committed to git with human-readable diffs\n- [ ] Documentation complete\n\n## DECISION LOG\n\n1. **TrailBase rejected**: Poor schema handling, ER diagram broken, field types incorrect\n2. **Pocketbase approved**: FK UX validated, version control viable, proven solution\n3. **sqlite-diffable for version control**: Same approach as libsql (already working)\n4. **Keep Drizzle schema.ts**: Source of truth for structure, generate Pocketbase schema from it\n\n## ESTIMATED TIME\n\n- Phase 1 (Schema): 30 mins\n- Phase 2 (Import): 1 hour\n- Phase 3 (Version control): 15 mins\n- Phase 4 (Docs): 15 mins\n- Phase 5 (VitePress): 30 mins\n\n**Total: ~2.5 hours** for complete Pocketbase content management system.\n\n## DEPENDENCIES\n\n- Pocketbase binary: `.pocketbase/pocketbase` (installed)\n- Python packages: pocketbase (installed)\n- sqlite-diffable: Already available from session 013\n- Existing data: `content/data/**/*.yml` (quality-validated)\n\n## ROLLBACK PLAN\n\nIf Pocketbase doesn't work out:\n1. Keep current SQLite + Drizzle approach\n2. Build minimal CRUD UI with Drizzle Studio or custom forms\n3. Fall back to manual YAML editing with quality validation\n\n## REFERENCE\n\n- Pocketbase docs: https://pocketbase.io/docs/\n- Agent research on collection API: Session 014, agent aa2e5cf\n- FK UX validation: Screenshot in session 014\n- sqlite-diffable: https://github.com/simonw/sqlite-diffable","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T12:26:26.334769-05:00","created_by":"alippold","updated_at":"2026-01-14T11:32:47.433447-05:00","closed_at":"2026-01-14T11:32:47.433447-05:00","close_reason":"Pocketbase implementation complete - v2 schema created, data migrated, FK relations working"}
{"id":"saf-site-vitepress-tex","title":"RECOVERY: Session 023 Context","description":"SESSION 023 RECOVERY - 2026-01-14\n\nWORKFLOW:\nThis project uses BEADS for task tracking and Pocketbase for content management.\nKey project context card: bd show saf-site-vitepress-33i\n\nPOCKETBASE CRITICAL INFO:\n- URL: http://127.0.0.1:8090\n- Admin: admin@localhost.com / testpassword123\n- PocketBase 0.23+ uses _superusers for auth (NOT admins API)\n- Start: cd .pocketbase \u0026\u0026 ./pocketbase serve\n\npb-cli CONTEXT:\n- 39 collections configured (9 v1 + 30 v2)\n- Auth valid, all v2_ collections added this session\n\nCOMPLETED THIS SESSION:\n\n1. Version field data cleanup \u0026 validation\n   - Removed \"v\" prefix from all version data (v2_content, profiles)\n   - DB stores \"1.0.0\", frontend adds \"v\" for display\n   - Added Pocketbase pattern validation (^[0-9].*$) to prevent bad data\n   - Migration: .pocketbase/pb_migrations/1768420000_add_version_validation.js\n   - Updated create-schema script and Drizzle schema for consistency\n\n2. Profile detail pages (dynamic routes)\n   - docs/validate/[slug].paths.ts - generates routes from Pocketbase\n   - docs/validate/[slug].md - template page\n   - ProfileDetail.vue - compact single-column layout\n   - Layout: Title+version, description, metadata tags, VitePress CTA buttons, details grid\n   - Using VitePress brand/alt button styling for consistency with home page\n\n3. pb-cli context setup\n   - Added all 30 v2 collections to pb-cli\n   - Can now query: pb collections v2_content list\n\nKEY FILES MODIFIED:\n- docs/.vitepress/theme/components/ProfileDetail.vue (NEW)\n- docs/validate/[slug].md (NEW)\n- docs/validate/[slug].paths.ts (NEW)\n- .pocketbase/pb_migrations/1768420000_add_version_validation.js (NEW)\n- docs/.vitepress/theme/index.ts (ProfileDetail registration)\n- docs/.vitepress/database/schema-v2.ts (version field comments)\n- scripts/create-schema-v2-collections.ts (pattern validation)\n- docs/.vitepress/theme/components/ProfileCard.vue (version display fix)\n\nGIT STATUS:\n- Branch: main\n- Last commit: bf0e024 (pushed)\n- All changes committed and pushed\n\nNEXT STEPS (Priority Order):\n1. Review profile detail page in browser - may need CTA button styling refinement\n2. Database population - fill in data using SAF sites as reference\n3. Populate v2 lookup tables (bd show saf-site-vitepress-6c8)\n4. Add org/team owner to ProfileCard\n\nNOTES:\n- User experienced Claude Code 2.1.7 bug (84% context but said out of context)\n- Profile detail page uses compact layout - no Overview section (README is source of truth)\n- Version validation pattern: ^[0-9].*$ (rejects v prefix, allows semver)\n- benchmark_version and releases.version NOT validated (support STIG V1R3 format)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-14T13:57:00.06306-05:00","created_by":"alippold","updated_at":"2026-01-14T14:04:21.693945-05:00","closed_at":"2026-01-14T14:04:21.693945-05:00","close_reason":"Context recovered, session 023 work complete"}
{"id":"saf-site-vitepress-tfc","title":"Create YAML import/export utilities","description":"## Create YAML Import/Export Utilities\n\n**Goal:** Build utilities to load, validate, and export YAML content files.\n\n**Location:** `docs/.vitepress/utils/yaml.ts`\n\n**Features:**\n\n### 1. YAML Loader with Zod Validation\n```typescript\nimport { parse } from 'yaml'\nimport { insertProfileSchema } from '../database/schema'\n\nexport async function loadProfiles(yamlPath: string) {\n  const content = await readFile(yamlPath, 'utf-8')\n  const parsed = parse(content)\n  \n  // Validate each profile with Zod\n  const validated = parsed.profiles.map(p =\u003e \n    insertProfileSchema.parse(p)\n  )\n  \n  return validated\n}\n```\n\n### 2. YAML Exporter\n```typescript\nexport function exportToYAML(data: Profile[]) {\n  return stringify({\n    _id: 'profiles',\n    _metadata: { ... },\n    profiles: data\n  })\n}\n```\n\n### 3. Import from saf-site-v4\n```typescript\n// Copy YAML files from saf-site-v4/content/data/\n// to saf-site-vitepress/content/data/\nexport async function importFromV4() {\n  const sourcePath = '/path/to/saf-site-v4/content/data'\n  const targetPath = './content/data'\n  \n  // Copy all .yml files\n  // Validate during copy\n}\n```\n\n**Testing:**\n- Load sample YAML file\n- Validate with Zod schema\n- Export back to YAML\n- Round-trip test (load → export → load → compare)\n\n**Dependencies:** Requires schema.ts (saf-site-vitepress-sc2)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-12T19:23:38.356292-05:00","created_by":"alippold","updated_at":"2026-01-14T11:05:51.245216-05:00","closed_at":"2026-01-14T11:05:51.245216-05:00","close_reason":"No longer needed - using Pocketbase API directly, not YAML","dependencies":[{"issue_id":"saf-site-vitepress-tfc","depends_on_id":"saf-site-vitepress-sc2","type":"blocks","created_at":"2026-01-12T19:23:38.636987-05:00","created_by":"alippold"},{"issue_id":"saf-site-vitepress-tfc","depends_on_id":"saf-site-vitepress-m6x","type":"blocks","created_at":"2026-01-12T19:46:41.950444-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-uab","title":"RECOVERY: Current Session Context","description":"SESSION 015 RECOVERY - 2026-01-13\n\nWORKFLOW:\nThis project uses BEADS for task tracking. See CLAUDE.md for VitePress development patterns and Pocketbase content management details.\n\nCOMPLETED THIS SESSION:\n✅ Phase 1 (30 mins): Created all 12 Pocketbase collections with proper FK relations\n  - Base: tags, organizations, technologies, standards, capabilities  \n  - With FKs: teams, profiles, hardening_profiles, tools\n  - Junction: profiles_tags, hardening_profiles_tags, validation_to_hardening\n  - Fixed TypeScript SDK: Use fields (not schema), relation options DIRECT (not nested in options)\n\n✅ Phase 2 (45 mins): Imported all data from YAML files\n  - 78 validation profiles, 5 hardening profiles\n  - 52 tags, 16 organizations, 8 technologies, 18 standards, 4 teams, 7 tools, 5 capabilities\n  - 92 profile-tag links, 25 hardening-tag links, 4 validation-hardening links\n  - All FK relationships properly resolved\n\n✅ Phase 3 (15 mins): Version control setup with sqlite-diffable\n  - Exported Pocketbase DB to git-friendly format\n  - 46 files in .pocketbase/pb_data/diffable/ (.metadata.json + .ndjson)\n  - Updated .gitignore for proper tracking\n\n✅ Phase 4 (15 mins): Documentation\n  - Created CONTENT-EDITING.md with complete workflow\n  - Covers editing, exporting, committing, troubleshooting\n\nIN PROGRESS:\n- saf-site-vitepress-tay: Full Pocketbase implementation (Phase 5 remaining)\n\nGIT STATUS:\n- Branch: main\n- Last commit: 7d4b384 (bd sync: 2026-01-13 13:39:11)\n- Previous commits: 95bdbad (Phase 3), 1a44d4f (Phase 1-2)\n- All work committed and pushed\n- Untracked: scripts/create-all-collections-simple.py, scripts/create-all-collections.py (test scripts)\n\nPOCKETBASE STATE:\n- Running at http://localhost:8090\n- Admin: admin@localhost.com / test1234567\n- 12 collections created with proper schema\n- All data imported and verified\n- Database exported to .pocketbase/pb_data/diffable/\n\nKEY DISCOVERIES:\n- Pocketbase TypeScript SDK uses 'fields' property (not 'schema')\n- Relation field options are DIRECT properties (not nested in 'options:' object)\n- Python SDK has parsing bugs but API calls succeed\n- pb-cli is for record CRUD, NOT schema management\n- sqlite-diffable exports to human-readable NDJSON (one record per line)\n\nNEXT STEPS (Priority Order):\n1. Phase 5 (30 mins): Update VitePress data loaders to read from Pocketbase\n   - Recommended: Export Pocketbase → JSON files, VitePress reads JSON at build time\n   - Alternative: VitePress data loaders query Pocketbase REST API directly\n2. Test VitePress browse pages with real Pocketbase data\n3. Verify FK expansion works in browse page filters\n\nBLOCKERS/NOTES:\n- Total time: 1.75 hours (under 2.5 hour estimate)\n- Pocketbase content management fully functional\n- All data now version-controlled in git as NDJSON\n- Next session should start with Phase 5 VitePress integration\n\nCRITICAL FILES:\n- scripts/create-all-collections.ts: Creates all 12 collections\n- scripts/import-yaml-data.ts: Imports YAML → Pocketbase\n- scripts/verify-collections.ts: Validates collection structure\n- .pocketbase/pb_data/diffable/: Git-tracked database export\n- CONTENT-EDITING.md: Content management documentation","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T13:40:06.50835-05:00","created_by":"alippold","updated_at":"2026-01-13T13:46:52.042032-05:00","closed_at":"2026-01-13T13:46:52.042032-05:00","close_reason":"Context recovered, starting Phase 5"}
{"id":"saf-site-vitepress-uen","title":"EPIC: Production Evaluation","description":"Final decision: Is VitePress production-ready for SAF? Test build performance, bundle size, search quality, deployment strategy.","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-12T17:23:52.893131-05:00","created_by":"alippold","updated_at":"2026-01-12T17:23:52.893131-05:00"}
{"id":"saf-site-vitepress-uw8","title":"EPIC: Component Library Decision","description":"## Decision: Reka UI\n\n**Chosen:** Reka UI 2.7.0 (already installed)\n\n**Why:**\n- Vue-native optimization (smaller bundle, better DX)\n- Works seamlessly with VitePress CSS variables\n- Transparency/visibility issues already solved\n- 45+ components, actively maintained\n- No additional dependencies (Tailwind not needed)\n\n**Alternatives Considered:**\n1. **Shadcn Vue** - Requires Tailwind CSS (conflicts with VitePress theme)\n2. **Headless UI** - Smaller component set, Vue is secondary to React\n3. **Ark UI** - Framework-agnostic (larger bundle), state machine complexity\n\n**Pattern Established:**\nSee ProfileFilters.vue for reference:\n- Use Reka UI primitives (SelectRoot, SelectTrigger, etc.)\n- Style with VitePress CSS variables (var(--vp-c-*))\n- Scoped styles in component\n- Full keyboard navigation and ARIA support\n\n**Status:** APPROVED - proceed with Reka UI for all components","status":"closed","priority":0,"issue_type":"epic","created_at":"2026-01-12T17:23:27.010415-05:00","created_by":"alippold","updated_at":"2026-01-12T18:37:57.553819-05:00","closed_at":"2026-01-12T18:37:57.553819-05:00","close_reason":"Closed"}
{"id":"saf-site-vitepress-vcz","title":"RECOVERY: Current Session Context","description":"SESSION 027 RECOVERY - 2026-01-15\n\nWORKFLOW:\nThis project uses BEADS for task tracking AND hub-and-spoke development standards.\n- Hub card: bd show saf-site-vitepress-ga0 (ALWAYS read first after compact)\n- Spoke card: bd show saf-site-vitepress-35u (Database \u0026 Pocketbase workflow)\n\nCOMPLETED THIS SESSION:\n- Fixed version prefix issue: stripped 'v' from profiles + v2_content (was showing \"vv1.0.0\")\n- Fixed documentation_url issue: cleared fake saf.mitre.org/profiles URLs (field is override-only)\n- Updated migration script: added normalizeVersion() function, fixed documentation_url\n- Integrated pb-cli: package.json scripts, README, CONTRIBUTING, setup.sh check\n- Created pb-cli backup (binary backup for disaster recovery)\n- Documented bd sync workflow in CLAUDE.md (commit ALL files before bd sync)\n- Created future epics: Monorepo, CI/CD, Backups, Production\n\nKEY TECHNICAL DETAILS:\n- VitePress data loaders query v2_content collection (NOT profiles v1)\n- Version display: DB stores \"1.0.0\", Vue template adds \"v\" prefix, CSS uppercases\n- documentation_url is an override field; default shows README via github_url\n- pb-cli context: \"local\" at http://127.0.0.1:8090, auth as _superusers\n- bd sync requires ALL files committed first (does git pull internally)\n\nGIT STATUS:\n- Branch: main\n- Last commit: 1a62b55 (docs: add bd sync troubleshooting to CLAUDE.md)\n- All changes committed and pushed\n\nNEXT STEPS (Priority Order):\n1. v1 Collection Cleanup (saf-site-vitepress-91d) - Remove old v1 collections\n2. Monorepo + Dev Docs (saf-site-vitepress-2jp) - pnpm workspaces + Turborepo\n3. Then decide: CI/CD, Backups, or Production deployment\n\nOPEN EPICS:\n- saf-site-vitepress-91d: v1 Collection Cleanup (P2) - NEXT\n- saf-site-vitepress-2jp: Monorepo with Site + Dev Docs (P1)\n- saf-site-vitepress-9et: CI/CD + PR Preview Deployments (P2)\n- saf-site-vitepress-zp8: Automated Database Backups (P3)\n- saf-site-vitepress-ik5: Production Deployment (P3)\n\nKEY FILES:\n- scripts/migrate-v1-to-v2.ts - Migration with normalizeVersion()\n- docs/.vitepress/loaders/profiles.data.ts - Queries v2_content\n- docs/.vitepress/theme/composables/useContentDetail.ts - Adds \"v\" prefix","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-14T23:56:02.149704-05:00","created_by":"alippold","updated_at":"2026-01-15T10:02:55.870572-05:00","closed_at":"2026-01-15T10:02:55.870572-05:00","close_reason":"Context recovered from Session 027, continuing with v1 cleanup"}
{"id":"saf-site-vitepress-z90","title":"EPIC: Browse Pages","description":"Content listing pages with filters and search: validation profiles, hardening profiles, standards. All use layout: doc with aside: false pattern.","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T17:23:44.493844-05:00","created_by":"alippold","updated_at":"2026-01-12T17:23:44.493844-05:00"}
{"id":"saf-site-vitepress-z95","title":"Update VitePress data loaders for v2 collections","description":"Update profiles.data.ts and create new loaders to query v2_* Pocketbase collections.\n\n## Current State\n- profiles.data.ts queries v1 'profiles' collection\n- No loaders for unified 'content' table or new collections\n\n## Target State\n- content.data.ts → queries v2_content (validation + hardening)\n- tools.data.ts → queries v2_tools\n- Update all expand parameters for v2 FK names\n\n## Files to Update\n- docs/.vitepress/loaders/profiles.data.ts → content.data.ts\n\n## Testing\n- pnpm build should succeed\n- Browse page should render profiles","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-14T11:07:31.246091-05:00","created_by":"alippold","updated_at":"2026-01-14T12:05:38.977008-05:00","closed_at":"2026-01-14T12:05:38.977008-05:00","close_reason":"Data loader updated for v2 schema, ProfileCard updated with status/version/short_name badges","dependencies":[{"issue_id":"saf-site-vitepress-z95","depends_on_id":"saf-site-vitepress-nzq","type":"blocks","created_at":"2026-01-14T11:19:56.423898-05:00","created_by":"alippold"}]}
{"id":"saf-site-vitepress-zp8","title":"EPIC: Automated Database Backups","description":"Scheduled GitHub Action for database backups, push to backups branch, retention policy","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-15T08:39:52.770185-05:00","created_by":"alippold","updated_at":"2026-01-15T08:39:52.770185-05:00"}
{"id":"saf-site-vitepress-zpe","title":"Add SAF training courses","description":"Add course records for SAF training classes.\n\n## Courses to Add\n- InSpec Developer Course\n- Heimdall User Training\n- SAF Overview Workshop\n- STIG Development with Vulcan\n\n## Related Records\n- course_resources: prerequisites, references\n- course_sessions: past and upcoming dates","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T11:19:39.244261-05:00","created_by":"alippold","updated_at":"2026-01-14T11:19:39.244261-05:00","dependencies":[{"issue_id":"saf-site-vitepress-zpe","depends_on_id":"saf-site-vitepress-6c8","type":"blocks","created_at":"2026-01-14T11:19:56.771065-05:00","created_by":"alippold"}]}
